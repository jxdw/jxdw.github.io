<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.0/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"jxdw.github.io","root":"/","scheme":"Pisces","version":"8.0.1","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12,"width":240},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="渐学顿悟">
<meta property="og:url" content="https://jxdw.github.io/page/2/index.html">
<meta property="og:site_name" content="渐学顿悟">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="渐学顿悟">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://jxdw.github.io/page/2/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>渐学顿悟</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="渐学顿悟" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">渐学顿悟</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">记录技术的学习和实践过程</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">12</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">122</span></a>

  </li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="渐学顿悟"
      src="/favicon.png">
  <p class="site-author-name" itemprop="name">渐学顿悟</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">122</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </section>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">
      

      
    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jxdw.github.io/2020/03/25/how_to_learn_a_language/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/favicon.png">
      <meta itemprop="name" content="渐学顿悟">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渐学顿悟">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/25/how_to_learn_a_language/" class="post-title-link" itemprop="url">【感悟】如何学习一门编程语言</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-25 19:17:59 19:17:59" itemprop="dateCreated datePublished" datetime="2020-03-25T19:17:59+08:00">2020-03-25 19:17:59</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-13 23:03:54 23:03:54" itemprop="dateModified" datetime="2020-10-13T23:03:54+08:00">2020-10-13 23:03:54</time>
      </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/03/25/how_to_learn_a_language/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/03/25/how_to_learn_a_language/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="https://jxdw.github.io/img/architecture/language_learn_timeline.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jxdw.github.io/2020/03/25/jishuzongjie-2019/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/favicon.png">
      <meta itemprop="name" content="渐学顿悟">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渐学顿悟">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/25/jishuzongjie-2019/" class="post-title-link" itemprop="url">2019年度的总结</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-03-25 10:35:47 10:35:47" itemprop="dateCreated datePublished" datetime="2020-03-25T10:35:47+08:00">2020-03-25 10:35:47</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-13 22:57:56 22:57:56" itemprop="dateModified" datetime="2020-10-13T22:57:56+08:00">2020-10-13 22:57:56</time>
      </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/03/25/jishuzongjie-2019/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/03/25/jishuzongjie-2019/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>2019年一直在”奔跑”，鲜有时间真正沉下心来想事情。<br>直到这次的突发情况被困老家35天，才有时间来想过去一年、以及未来需要做的事情：<br>1.物理层的东西是我们不可控的，只能依靠有想法的企业或者产业基金去投入。<br>2.操作系统和网络类也不是我们能接触到的，只能累积经验。<br>3.我们能做的就是编程语言和中间件做积累和突破。<br><img src="https://jxdw.github.io/img/architecture/silu.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jxdw.github.io/2019/12/01/trace-jaeger-1150-install/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/favicon.png">
      <meta itemprop="name" content="渐学顿悟">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渐学顿悟">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/12/01/trace-jaeger-1150-install/" class="post-title-link" itemprop="url">【zipkin/jaeger使用系列】jaeger v1.15.1安装、配置</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-12-01 23:00:00 23:00:00" itemprop="dateCreated datePublished" datetime="2019-12-01T23:00:00+08:00">2019-12-01 23:00:00</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-14 23:34:47 23:34:47" itemprop="dateModified" datetime="2020-10-14T23:34:47+08:00">2020-10-14 23:34:47</time>
      </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2019/12/01/trace-jaeger-1150-install/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/12/01/trace-jaeger-1150-install/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>jaeger又更新新版本了，虽然不是什么大版本，但是还是更新测试环境版本吧。</p>
<h1 id="官方指南和常规方法"><a href="#官方指南和常规方法" class="headerlink" title="官方指南和常规方法"></a>官方指南和常规方法</h1><p>官方文档：<a target="_blank" rel="noopener" href="https://www.jaegertracing.io/docs/1.15/cli/">https://www.jaegertracing.io/docs/1.15/cli/</a><br>看了官方文档，照着去测试环境操作，没有看到自己想看到的效果(jaeger_colletor的help效果如下).说好的elasticsearch、kafka配置呢？<br><img src="https://jxdw.github.io/img/business/trace/jaeger_collector_use_case.png"></p>
<h1 id="help与环境变量耦合"><a href="#help与环境变量耦合" class="headerlink" title="help与环境变量耦合"></a>help与环境变量耦合</h1><h2 id="jaeger-collector使用elasticsearch为存储"><a href="#jaeger-collector使用elasticsearch为存储" class="headerlink" title="jaeger-collector使用elasticsearch为存储"></a>jaeger-collector使用elasticsearch为存储</h2><p>大胆的猜测，help命令和环境变量耦合了。输入：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SPAN_STORAGE_TYPE&#x3D;elasticsearch .&#x2F;jaeger-collector --help</span><br></pre></td></tr></table></figure>

<p>果然，输出的效果如下，真的是防不甚防啊。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2019-12-01 22:18:33 maxprocs: Leaving GOMAXPROCS&#x3D;4: CPU quota undefined</span><br><span class="line">Jaeger collector receives traces from Jaeger agents and runs them through a processing pipeline.</span><br><span class="line">Usage:</span><br><span class="line">  jaeger-collector [flags]</span><br><span class="line">  jaeger-collector [command]</span><br><span class="line">Available Commands:</span><br><span class="line">  docs        Generates documentation</span><br><span class="line">  env         Help about environment variables.</span><br><span class="line">  help        Help about any command</span><br><span class="line">  version     Print the version.</span><br><span class="line">Flags:</span><br><span class="line">      --admin-http-port int                                The http port for the admin server, including health check, &#x2F;metrics, etc. (default 14269)</span><br><span class="line">      --collector.grpc-port int                            The gRPC port for the collector service (default 14250)</span><br><span class="line">      --collector.grpc.tls                                 Enable TLS on the server</span><br><span class="line">      --collector.grpc.tls.cert string                     Path to a TLS Certificate file, used to identify this server to clients</span><br><span class="line">      --collector.grpc.tls.client-ca string                Path to a TLS CA (Certification Authority) file used to verify certificates presented by clients (if unset, all clients are permitted)</span><br><span class="line">      --collector.grpc.tls.client.ca string                (deprecated) see --collector.grpc.tls.client-ca</span><br><span class="line">      --collector.grpc.tls.key string                      Path to a TLS Private Key file, used to identify this server to clients</span><br><span class="line">      --collector.http-port int                            The HTTP port for the collector service (default 14268)</span><br><span class="line">      --collector.num-workers int                          The number of workers pulling items from the queue (default 50)</span><br><span class="line">      --collector.port int                                 The TChannel port for the collector service (default 14267)</span><br><span class="line">      --collector.queue-size int                           The queue size of the collector (default 2000)</span><br><span class="line">      --collector.zipkin.allowed-headers string            Comma separated list of allowed headers for the Zipkin collector service, default content-type (default &quot;content-type&quot;)</span><br><span class="line">      --collector.zipkin.allowed-origins string            Comma separated list of allowed origins for the Zipkin collector service, default accepts all (default &quot;*&quot;)</span><br><span class="line">      --collector.zipkin.http-port int                     The HTTP port for the Zipkin collector service e.g. 9411</span><br><span class="line">      --config-file string                                 Configuration file in JSON, TOML, YAML, HCL, or Java properties formats (default none). See spf13&#x2F;viper for precedence.</span><br><span class="line">      --downsampling.hashsalt string                       Salt used when hashing trace id for downsampling.</span><br><span class="line">      --downsampling.ratio float                           Ratio of spans passed to storage after downsampling (between 0 and 1), e.g ratio &#x3D; 0.3 means we are keeping 30% of spans and dropping 70% of spans; ratio &#x3D; 1.0 disables downsampling. (default 1)</span><br><span class="line">      --es-archive.bulk.actions int                        The number of requests that can be enqueued before the bulk processor decides to commit</span><br><span class="line">      --es-archive.bulk.flush-interval duration            A time.Duration after which bulk requests are committed, regardless of other thresholds. Set to zero to disable. By default, this is disabled. (default 0s)</span><br><span class="line">      --es-archive.bulk.size int                           The number of bytes that the bulk requests can take up before the bulk processor decides to commit</span><br><span class="line">      --es-archive.bulk.workers int                        The number of workers that are able to receive bulk requests and eventually commit them to Elasticsearch</span><br><span class="line">      --es-archive.create-index-templates                  Create index templates at application startup. Set to false when templates are installed manually.</span><br><span class="line">      --es-archive.enabled                                 Enable extra storage</span><br><span class="line">      --es-archive.index-prefix string                     Optional prefix of Jaeger indices. For example &quot;production&quot; creates &quot;production-jaeger-*&quot;.</span><br><span class="line">      --es-archive.max-num-spans int                       The maximum number of spans to fetch at a time per query in Elasticsearch</span><br><span class="line">      --es-archive.max-span-age duration                   The maximum lookback for spans in Elasticsearch (default 0s)</span><br><span class="line">      --es-archive.num-replicas int                        The number of replicas per index in Elasticsearch</span><br><span class="line">      --es-archive.num-shards int                          The number of shards per index in Elasticsearch</span><br><span class="line">      --es-archive.password string                         The password required by Elasticsearch</span><br><span class="line">      --es-archive.server-urls string                      The comma-separated list of Elasticsearch servers, must be full url i.e. http:&#x2F;&#x2F;localhost:9200</span><br><span class="line">      --es-archive.sniffer                                 The sniffer config for Elasticsearch; client uses sniffing process to find all nodes automatically, disable if not required</span><br><span class="line">      --es-archive.tags-as-fields.all                      (experimental) Store all span and process tags as object fields. If true .tags-as-fields.config-file is ignored. Binary tags are always stored as nested objects.</span><br><span class="line">      --es-archive.tags-as-fields.config-file string       (experimental) Optional path to a file containing tag keys which will be stored as object fields. Each key should be on a separate line.</span><br><span class="line">      --es-archive.tags-as-fields.dot-replacement string   (experimental) The character used to replace dots (&quot;.&quot;) in tag keys stored as object fields.</span><br><span class="line">      --es-archive.timeout duration                        Timeout used for queries. A Timeout of zero means no timeout (default 0s)</span><br><span class="line">      --es-archive.tls                                     Enable TLS with client certificates.</span><br><span class="line">      --es-archive.tls.ca string                           Path to TLS CA file</span><br><span class="line">      --es-archive.tls.cert string                         Path to TLS certificate file</span><br><span class="line">      --es-archive.tls.key string                          Path to TLS key file</span><br><span class="line">      --es-archive.tls.skip-host-verify                    (insecure) Skip server&#39;s certificate chain and host name verification</span><br><span class="line">      --es-archive.token-file string                       Path to a file containing bearer token. This flag also loads CA if it is specified.</span><br><span class="line">      --es-archive.use-aliases                             (experimental) Use read and write aliases for indices. Use this option with Elasticsearch rollover API. It requires an external component to create aliases before startup and then performing its management. Note that es-archive.max-span-age is not taken into the account and has to be substituted by external component managing read alias.</span><br><span class="line">      --es-archive.username string                         The username required by Elasticsearch. The basic authentication also loads CA if it is specified.</span><br><span class="line">      --es-archive.version uint                            The major Elasticsearch version. If not specified, the value will be auto-detected from Elasticsearch.</span><br><span class="line">      --es.bulk.actions int                                The number of requests that can be enqueued before the bulk processor decides to commit (default 1000)</span><br><span class="line">      --es.bulk.flush-interval duration                    A time.Duration after which bulk requests are committed, regardless of other thresholds. Set to zero to disable. By default, this is disabled. (default 200ms)</span><br><span class="line">      --es.bulk.size int                                   The number of bytes that the bulk requests can take up before the bulk processor decides to commit (default 5000000)</span><br><span class="line">      --es.bulk.workers int                                The number of workers that are able to receive bulk requests and eventually commit them to Elasticsearch (default 1)</span><br><span class="line">      --es.create-index-templates                          Create index templates at application startup. Set to false when templates are installed manually. (default true)</span><br><span class="line">      --es.index-prefix string                             Optional prefix of Jaeger indices. For example &quot;production&quot; creates &quot;production-jaeger-*&quot;.</span><br><span class="line">      --es.max-num-spans int                               The maximum number of spans to fetch at a time per query in Elasticsearch (default 10000)</span><br><span class="line">      --es.max-span-age duration                           The maximum lookback for spans in Elasticsearch (default 72h0m0s)</span><br><span class="line">      --es.num-replicas int                                The number of replicas per index in Elasticsearch (default 1)</span><br><span class="line">      --es.num-shards int                                  The number of shards per index in Elasticsearch (default 5)</span><br><span class="line">      --es.password string                                 The password required by Elasticsearch</span><br><span class="line">      --es.server-urls string                              The comma-separated list of Elasticsearch servers, must be full url i.e. http:&#x2F;&#x2F;localhost:9200 (default &quot;http:&#x2F;&#x2F;127.0.0.1:9200&quot;)</span><br><span class="line">      --es.sniffer                                         The sniffer config for Elasticsearch; client uses sniffing process to find all nodes automatically, disable if not required</span><br><span class="line">      --es.tags-as-fields.all                              (experimental) Store all span and process tags as object fields. If true .tags-as-fields.config-file is ignored. Binary tags are always stored as nested objects.</span><br><span class="line">      --es.tags-as-fields.config-file string               (experimental) Optional path to a file containing tag keys which will be stored as object fields. Each key should be on a separate line.</span><br><span class="line">      --es.tags-as-fields.dot-replacement string           (experimental) The character used to replace dots (&quot;.&quot;) in tag keys stored as object fields. (default &quot;@&quot;)</span><br><span class="line">      --es.timeout duration                                Timeout used for queries. A Timeout of zero means no timeout (default 0s)</span><br><span class="line">      --es.tls                                             Enable TLS with client certificates.</span><br><span class="line">      --es.tls.ca string                                   Path to TLS CA file</span><br><span class="line">      --es.tls.cert string                                 Path to TLS certificate file</span><br><span class="line">      --es.tls.key string                                  Path to TLS key file</span><br><span class="line">      --es.tls.skip-host-verify                            (insecure) Skip server&#39;s certificate chain and host name verification</span><br><span class="line">      --es.token-file string                               Path to a file containing bearer token. This flag also loads CA if it is specified.</span><br><span class="line">      --es.use-aliases                                     (experimental) Use read and write aliases for indices. Use this option with Elasticsearch rollover API. It requires an external component to create aliases before startup and then performing its management. Note that es.max-span-age is not taken into the account and has to be substituted by external component managing read alias.</span><br><span class="line">      --es.username string                                 The username required by Elasticsearch. The basic authentication also loads CA if it is specified.</span><br><span class="line">      --es.version uint                                    The major Elasticsearch version. If not specified, the value will be auto-detected from Elasticsearch.</span><br><span class="line">      --health-check-http-port int                         (deprecated) see --admin-http-port</span><br><span class="line">  -h, --help                                               help for jaeger-collector</span><br><span class="line">      --log-level string                                   Minimal allowed log Level. For more levels see https:&#x2F;&#x2F;github.com&#x2F;uber-go&#x2F;zap (default &quot;info&quot;)</span><br><span class="line">      --metrics-backend string                             Defines which metrics backend to use for metrics reporting: expvar, prometheus, none (default &quot;prometheus&quot;)</span><br><span class="line">      --metrics-http-route string                          Defines the route of HTTP endpoint for metrics backends that support scraping (default &quot;&#x2F;metrics&quot;)</span><br><span class="line">      --sampling.strategies-file string                    The path for the sampling strategies file in JSON format. See sampling documentation to see format of the file</span><br><span class="line">      --span-storage.type string                           (deprecated) please use SPAN_STORAGE_TYPE environment variable. Run this binary with the &#39;env&#39; command for help.</span><br><span class="line">Use &quot;jaeger-collector [command] --help&quot; for more information about a command.</span><br></pre></td></tr></table></figure>

<h2 id="jaeger-collector使用kafka为存储"><a href="#jaeger-collector使用kafka为存储" class="headerlink" title="jaeger-collector使用kafka为存储"></a>jaeger-collector使用kafka为存储</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SPAN_STORAGE_TYPE&#x3D;kafka .&#x2F;jaeger-collector --help</span><br></pre></td></tr></table></figure>

<p>输出如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2019&#x2F;12&#x2F;01 22:31:21 maxprocs: Leaving GOMAXPROCS&#x3D;4: CPU quota undefined</span><br><span class="line">Jaeger collector receives traces from Jaeger agents and runs them through a processing pipeline.</span><br><span class="line">Usage:</span><br><span class="line">  jaeger-collector [flags]</span><br><span class="line">  jaeger-collector [command]</span><br><span class="line">Available Commands:</span><br><span class="line">  docs        Generates documentation</span><br><span class="line">  env         Help about environment variables.</span><br><span class="line">  help        Help about any command</span><br><span class="line">  version     Print the version.</span><br><span class="line">Flags:</span><br><span class="line">      --admin-http-port int                           The http port for the admin server, including health check, &#x2F;metrics, etc. (default 14269)</span><br><span class="line">      --collector.grpc-port int                       The gRPC port for the collector service (default 14250)</span><br><span class="line">      --collector.grpc.tls                            Enable TLS on the server</span><br><span class="line">      --collector.grpc.tls.cert string                Path to a TLS Certificate file, used to identify this server to clients</span><br><span class="line">      --collector.grpc.tls.client-ca string           Path to a TLS CA (Certification Authority) file used to verify certificates presented by clients (if unset, all clients are permitted)</span><br><span class="line">      --collector.grpc.tls.client.ca string           (deprecated) see --collector.grpc.tls.client-ca</span><br><span class="line">      --collector.grpc.tls.key string                 Path to a TLS Private Key file, used to identify this server to clients</span><br><span class="line">      --collector.http-port int                       The HTTP port for the collector service (default 14268)</span><br><span class="line">      --collector.num-workers int                     The number of workers pulling items from the queue (default 50)</span><br><span class="line">      --collector.port int                            The TChannel port for the collector service (default 14267)</span><br><span class="line">      --collector.queue-size int                      The queue size of the collector (default 2000)</span><br><span class="line">      --collector.zipkin.allowed-headers string       Comma separated list of allowed headers for the Zipkin collector service, default content-type (default &quot;content-type&quot;)</span><br><span class="line">      --collector.zipkin.allowed-origins string       Comma separated list of allowed origins for the Zipkin collector service, default accepts all (default &quot;*&quot;)</span><br><span class="line">      --collector.zipkin.http-port int                The HTTP port for the Zipkin collector service e.g. 9411</span><br><span class="line">      --config-file string                            Configuration file in JSON, TOML, YAML, HCL, or Java properties formats (default none). See spf13&#x2F;viper for precedence.</span><br><span class="line">      --downsampling.hashsalt string                  Salt used when hashing trace id for downsampling.</span><br><span class="line">      --downsampling.ratio float                      Ratio of spans passed to storage after downsampling (between 0 and 1), e.g ratio &#x3D; 0.3 means we are keeping 30% of spans and dropping 70% of spans; ratio &#x3D; 1.0 disables downsampling. (default 1)</span><br><span class="line">      --health-check-http-port int                    (deprecated) see --admin-http-port</span><br><span class="line">  -h, --help                                          help for jaeger-collector</span><br><span class="line">      --kafka.producer.authentication string          Authentication type used to authenticate with kafka cluster. e.g. none, kerberos, tls (default &quot;none&quot;)</span><br><span class="line">      --kafka.producer.brokers string                 The comma-separated list of kafka brokers. i.e. &#39;127.0.0.1:9092,0.0.0:1234&#39; (default &quot;127.0.0.1:9092&quot;)</span><br><span class="line">      --kafka.producer.compression string             (experimental) Type of compression (none, gzip, snappy, lz4, zstd) to use on messages (default &quot;none&quot;)</span><br><span class="line">      --kafka.producer.compression-level int          (experimental) compression level to use on messages. gzip &#x3D; 1-9 (default &#x3D; 6), snappy &#x3D; none, lz4 &#x3D; 1-17 (default &#x3D; 9), zstd &#x3D; -131072 - 22 (default &#x3D; 3)</span><br><span class="line">      --kafka.producer.encoding string                Encoding of spans (&quot;json&quot; or &quot;protobuf&quot;) sent to kafka. (default &quot;protobuf&quot;)</span><br><span class="line">      --kafka.producer.kerberos.config-file string    Path to Kerberos configuration. i.e &#x2F;etc&#x2F;krb5.conf (default &quot;&#x2F;etc&#x2F;krb5.conf&quot;)</span><br><span class="line">      --kafka.producer.kerberos.keytab-file string    Path to keytab file. i.e &#x2F;etc&#x2F;security&#x2F;kafka.keytab (default &quot;&#x2F;etc&#x2F;security&#x2F;kafka.keytab&quot;)</span><br><span class="line">      --kafka.producer.kerberos.password string       The Kerberos password used for authenticate with KDC</span><br><span class="line">      --kafka.producer.kerberos.realm string          Kerberos realm</span><br><span class="line">      --kafka.producer.kerberos.service-name string   Kerberos service name (default &quot;kafka&quot;)</span><br><span class="line">      --kafka.producer.kerberos.use-keytab            Use of keytab instead of password, if this is true, keytab file will be used instead of password</span><br><span class="line">      --kafka.producer.kerberos.username string       The Kerberos username used for authenticate with KDC</span><br><span class="line">      --kafka.producer.protocol-version string        Kafka protocol version - must be supported by kafka server</span><br><span class="line">      --kafka.producer.required-acks string           (experimental) Required kafka broker acknowledgement. i.e. noack, local, all (default &quot;local&quot;)</span><br><span class="line">      --kafka.producer.tls.ca string                  Path to the TLS CA for the Kafka connection</span><br><span class="line">      --kafka.producer.tls.cert string                Path to the TLS Certificate for the Kafka connection</span><br><span class="line">      --kafka.producer.tls.key string                 Path to the TLS Key for the Kafka connection</span><br><span class="line">      --kafka.producer.topic string                   The name of the kafka topic (default &quot;jaeger-spans&quot;)</span><br><span class="line">      --log-level string                              Minimal allowed log Level. For more levels see https:&#x2F;&#x2F;github.com&#x2F;uber-go&#x2F;zap (default &quot;info&quot;)</span><br><span class="line">      --metrics-backend string                        Defines which metrics backend to use for metrics reporting: expvar, prometheus, none (default &quot;prometheus&quot;)</span><br><span class="line">      --metrics-http-route string                     Defines the route of HTTP endpoint for metrics backends that support scraping (default &quot;&#x2F;metrics&quot;)</span><br><span class="line">      --sampling.strategies-file string               The path for the sampling strategies file in JSON format. See sampling documentation to see format of the file</span><br><span class="line">      --span-storage.type string                      (deprecated) please use SPAN_STORAGE_TYPE environment variable. Run this binary with the &#39;env&#39; command for help.</span><br><span class="line">Use &quot;jaeger-collector [command] --help&quot; for more information about a command.</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jxdw.github.io/2019/10/07/prometheus_monitor_rabbitmq/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/favicon.png">
      <meta itemprop="name" content="渐学顿悟">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渐学顿悟">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/07/prometheus_monitor_rabbitmq/" class="post-title-link" itemprop="url">【prometheus知识体系】Prometheus监控rabbitmq3.8.0</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-10-07 12:46:48 12:46:48" itemprop="dateCreated datePublished" datetime="2019-10-07T12:46:48+08:00">2019-10-07 12:46:48</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-10 23:22:17 23:22:17" itemprop="dateModified" datetime="2020-10-10T23:22:17+08:00">2020-10-10 23:22:17</time>
      </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2019/10/07/prometheus_monitor_rabbitmq/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/10/07/prometheus_monitor_rabbitmq/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><h2 id="官方介绍"><a href="#官方介绍" class="headerlink" title="官方介绍"></a>官方介绍</h2><p>链接: <a target="_blank" rel="noopener" href="https://www.rabbitmq.com/prometheus.html#overview-prometheus">https://www.rabbitmq.com/prometheus.html#overview-prometheus</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">As of 3.8.0, RabbitMQ ships with built-in Prometheus &amp; Grafana support.</span><br><span class="line">Support for Prometheus metric collector ships in the rabbitmq_prometheus plugin. The plugin exposes all RabbitMQ metrics on a dedicated TCP port, in Prometheus text format.</span><br><span class="line">These metrics provide a deep insights into the state of RabbitMQ nodes and the runtime. They make reasoning about the behaviour of RabbitMQ, applications that use it and various infrastructure elements a lot more informed.</span><br></pre></td></tr></table></figure>

<h2 id="版本依赖"><a href="#版本依赖" class="headerlink" title="版本依赖"></a>版本依赖</h2><p><img src="https://jxdw.github.io/img/business/rabbitmq/rabbitmq_3.8.0_changelog.png"></p>
<p><img src="https://jxdw.github.io/img/business/rabbitmq/rabbitmq_3.8.0_required_erlang_version.png"></p>
<h1 id="安装过程"><a href="#安装过程" class="headerlink" title="安装过程"></a>安装过程</h1><h2 id="安装erlang"><a href="#安装erlang" class="headerlink" title="安装erlang"></a>安装erlang</h2><p>vim /etc/yum.repos.d/rabbitmq-erlang.repo</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[rabbitmq-erlang]</span><br><span class="line">name&#x3D;rabbitmq-erlang</span><br><span class="line">baseurl&#x3D;https:&#x2F;&#x2F;dl.bintray.com&#x2F;rabbitmq-erlang&#x2F;rpm&#x2F;erlang&#x2F;22&#x2F;el&#x2F;7</span><br><span class="line">gpgcheck&#x3D;1</span><br><span class="line">gpgkey&#x3D;https:&#x2F;&#x2F;dl.bintray.com&#x2F;rabbitmq&#x2F;Keys&#x2F;rabbitmq-release-signing-key.asc</span><br><span class="line">repo_gpgcheck&#x3D;0</span><br><span class="line">enabled&#x3D;1</span><br></pre></td></tr></table></figure>

<p>输入 命令，安装erlang。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rpm -import https:&#x2F;&#x2F;dl.bintray.com&#x2F;rabbitmq&#x2F;Keys&#x2F;rabbitmq-release-signing-key.asc</span><br><span class="line">yum install  erlang</span><br><span class="line">yum install rabbitmq-server</span><br></pre></td></tr></table></figure>

<h2 id="安装rabbitmq-server"><a href="#安装rabbitmq-server" class="headerlink" title="安装rabbitmq-server"></a>安装rabbitmq-server</h2><p>vim /etc/yum.repos.d/rabbitmq.repo</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[bintray-rabbitmq-server]</span><br><span class="line">name&#x3D;bintray-rabbitmq-rpm</span><br><span class="line">baseurl&#x3D;https:&#x2F;&#x2F;dl.bintray.com&#x2F;rabbitmq&#x2F;rpm&#x2F;rabbitmq-server&#x2F;v3.8.x&#x2F;el&#x2F;7&#x2F;</span><br><span class="line">gpgcheck&#x3D;0</span><br><span class="line">repo_gpgcheck&#x3D;0</span><br><span class="line">enabled&#x3D;1</span><br></pre></td></tr></table></figure>

<h2 id="修改配置，并授权"><a href="#修改配置，并授权" class="headerlink" title="修改配置，并授权"></a>修改配置，并授权</h2><p>vim /etc/rabbitmq/rabbitmq.conf</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#log.dir &#x3D; &#x2F;data&#x2F;rabbitmq&#x2F;log</span><br><span class="line">log.file &#x3D; rabbit.log</span><br><span class="line"></span><br><span class="line">log.file.rotation.date&#x3D;$D0</span><br><span class="line">log.file.rotation.size&#x3D;0</span><br></pre></td></tr></table></figure>
<p>vim /etc/rabbitmq/rabbitmq-env.conf</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">RABBITMQ_MNESIA_BASE&#x3D;&#x2F;data&#x2F;rabbitmq&#x2F;mnesia</span><br><span class="line">RABBITMQ_LOG_BASE&#x3D;&#x2F;data&#x2F;rabbitmq&#x2F;log</span><br></pre></td></tr></table></figure>

<p>授权给rabbitmq用户。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">chown -R rabbitmq:rabbitmq &#x2F;var&#x2F;lib&#x2F;rabbitmq&#x2F;</span><br><span class="line">mkdir -p data&#x2F;rabbitmq&#x2F;log</span><br><span class="line">mkdir -p &#x2F;data&#x2F;rabbitmq&#x2F;mnesia</span><br><span class="line">chown -R rabbitmq:rabbitmq &#x2F;data&#x2F;rabbitmq&#x2F;</span><br></pre></td></tr></table></figure>
<h2 id="启动服务，并启动插件"><a href="#启动服务，并启动插件" class="headerlink" title="启动服务，并启动插件"></a>启动服务，并启动插件</h2><p>1.启动rabbitmq-server服务</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">systemctl start rabbitmq-server</span><br><span class="line">systemctl status rabbitmq-server</span><br></pre></td></tr></table></figure>
<p>2.启动management插件。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rabbitmq-plugins enable rabbitmq_management</span><br></pre></td></tr></table></figure>
<p>3.admin用户授权</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rabbitmqctl add_user admin admin</span><br><span class="line">rabbitmqctl set_user_tags admin administrator</span><br><span class="line">rabbitmqctl set_permissions -p &#x2F; admin &quot;.*&quot; &quot;.*&quot; &quot;.*&quot;</span><br><span class="line">rabbitmqctl status</span><br></pre></td></tr></table></figure>
<p>4.查看插件<br>输入命令:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rabbitmq-plugins list</span><br></pre></td></tr></table></figure>
<p><img src="https://jxdw.github.io/img/business/rabbitmq/rabbitmq_3.8.0_plugin_list.png"></p>
<p>5.启动rabbitmq_prometheus插件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rabbitmq-plugins enable rabbitmq_prometheus</span><br></pre></td></tr></table></figure>

<h1 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h1><h2 id="命令行输入rabbitmqctl-status"><a href="#命令行输入rabbitmqctl-status" class="headerlink" title="命令行输入rabbitmqctl status"></a>命令行输入rabbitmqctl status</h2><p><img src="https://jxdw.github.io/img/monitor/prometheus_monitor_rabbitmq_1.png"></p>
<p><img src="https://jxdw.github.io/img/monitor/prometheus_monitor_rabbitmq_2.png"></p>
<h2 id="浏览器访问"><a href="#浏览器访问" class="headerlink" title="浏览器访问"></a>浏览器访问</h2><p><img src="https://jxdw.github.io/img/monitor/prometheus_monitor_rabbitmq_3.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jxdw.github.io/2019/10/01/trace-jaeger-1140-install/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/favicon.png">
      <meta itemprop="name" content="渐学顿悟">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渐学顿悟">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/01/trace-jaeger-1140-install/" class="post-title-link" itemprop="url">【zipkin/jaeger使用系列】jaeger v1.14.0安装、配置</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-10-01 19:00:00 19:00:00" itemprop="dateCreated datePublished" datetime="2019-10-01T19:00:00+08:00">2019-10-01 19:00:00</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-14 23:03:47 23:03:47" itemprop="dateModified" datetime="2020-10-14T23:03:47+08:00">2020-10-14 23:03:47</time>
      </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2019/10/01/trace-jaeger-1140-install/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/10/01/trace-jaeger-1140-install/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Jaeger项目背景和整体架构"><a href="#Jaeger项目背景和整体架构" class="headerlink" title="Jaeger项目背景和整体架构"></a>Jaeger项目背景和整体架构</h1><h2 id="项目背景"><a href="#项目背景" class="headerlink" title="项目背景"></a>项目背景</h2><p>Jaeger项目是一套受到Dapper与OpenZipkin启发构建而成的分布式跟踪平台，由Uber公司最初以开源方式公布，随后加入了云原生计算基金会。该项目主要用于:监控并诊断基于微服务架构的分布式系统，具体涵盖：</p>
<ul>
<li>分布式上下文传播</li>
<li>分布式事务监控</li>
<li>根本原因分析</li>
<li>服务依赖关系分析</li>
<li>性能/延迟优化</li>
</ul>
<h2 id="整体架构"><a href="#整体架构" class="headerlink" title="整体架构"></a>整体架构</h2><p><img src="https://jxdw.github.io/img/business/trace/jaeger-architecture.png"></p>
<h1 id="下载安装和配置"><a href="#下载安装和配置" class="headerlink" title="下载安装和配置"></a>下载安装和配置</h1><h2 id="安装前置条件"><a href="#安装前置条件" class="headerlink" title="安装前置条件"></a>安装前置条件</h2><ul>
<li>已经安装elasticsearch集群</li>
<li>安装好prometheus监控</li>
</ul>
<h2 id="从github下载二进制包"><a href="#从github下载二进制包" class="headerlink" title="从github下载二进制包"></a>从github下载二进制包</h2><p>下载地址：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;jaegertracing&#x2F;jaeger&#x2F;releases&#x2F;download&#x2F;v1.14.0&#x2F;jaeger-1.14.0-linux-amd64.tar.gz</span><br></pre></td></tr></table></figure>

<h2 id="解压和配置"><a href="#解压和配置" class="headerlink" title="解压和配置"></a>解压和配置</h2><h3 id="编写collector启动脚本start-colloector-sh"><a href="#编写collector启动脚本start-colloector-sh" class="headerlink" title="编写collector启动脚本start-colloector.sh"></a>编写collector启动脚本start-colloector.sh</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">export SPAN_STORAGE_TYPE&#x3D;elasticsearch</span><br><span class="line">nohup .&#x2F;jaeger-collector  --es.server-urls http:&#x2F;&#x2F;elasticsearch节点1的ip和端口&#x2F;,http:&#x2F;&#x2F;elasticsearch节点2的ip和端口&#x2F;,http&#x3D;:&#x2F;&#x2F;elasticsearch节点3的ip和端口&#x2F;  --log-level&#x3D;debug &gt; collector.log  2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>

<h3 id="编写query启动脚本start-query-sh"><a href="#编写query启动脚本start-query-sh" class="headerlink" title="编写query启动脚本start-query.sh"></a>编写query启动脚本start-query.sh</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">export SPAN_STORAGE_TYPE&#x3D;elasticsearch</span><br><span class="line">nohup .&#x2F;jaeger-query --span-storage.type&#x3D;elasticsearch --es.server-urls&#x3D;http:&#x2F;&#x2F;elasticsearch节点1的ip和端口&#x2F;,http:&#x2F;&#x2F;elasticsearch节点2的ip和端口&#x2F;,http&#x3D;:&#x2F;&#x2F;elasticsearch节点3的ip和端口&#x2F;   &gt; query.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>

<h3 id="编写agent启动脚本start-agent-sh"><a href="#编写agent启动脚本start-agent-sh" class="headerlink" title="编写agent启动脚本start-agent.sh"></a>编写agent启动脚本start-agent.sh</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">export SPAN_STORAGE_TYPE&#x3D;elasticsearch</span><br><span class="line">nohup  .&#x2F;jaeger-agent  --collector.host-port&#x3D;192.168.172.9:14267 --discovery.min-peers&#x3D;1 --log-level&#x3D;debug &gt; agent.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>

<h3 id="配置prometheus"><a href="#配置prometheus" class="headerlink" title="配置prometheus"></a>配置prometheus</h3><p>配置监听14269端口</p>
<h1 id="启动效果"><a href="#启动效果" class="headerlink" title="启动效果"></a>启动效果</h1><p><img src="https://jxdw.github.io/img/business/trace/jaeger-ui.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jxdw.github.io/2019/08/21/go_run_principle/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/favicon.png">
      <meta itemprop="name" content="渐学顿悟">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渐学顿悟">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/08/21/go_run_principle/" class="post-title-link" itemprop="url">【golang底层实现系列】go语言运行时的工作过程</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-08-21 18:41:34 18:41:34" itemprop="dateCreated datePublished" datetime="2019-08-21T18:41:34+08:00">2019-08-21 18:41:34</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-19 23:26:15 23:26:15" itemprop="dateModified" datetime="2020-10-19T23:26:15+08:00">2020-10-19 23:26:15</time>
      </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2019/08/21/go_run_principle/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/08/21/go_run_principle/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="https://jxdw.github.io/img/program/go/how_main_run.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jxdw.github.io/2019/08/21/redis_golang_client_insert_billion_data/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/favicon.png">
      <meta itemprop="name" content="渐学顿悟">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渐学顿悟">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/08/21/redis_golang_client_insert_billion_data/" class="post-title-link" itemprop="url">【redis使用系列】redis的go client写入百万个测试数据</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-08-21 17:02:30 17:02:30" itemprop="dateCreated datePublished" datetime="2019-08-21T17:02:30+08:00">2019-08-21 17:02:30</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-13 23:23:37 23:23:37" itemprop="dateModified" datetime="2020-10-13T23:23:37+08:00">2020-10-13 23:23:37</time>
      </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2019/08/21/redis_golang_client_insert_billion_data/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/08/21/redis_golang_client_insert_billion_data/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>最近为了做实验，需要redis中有百万的数据。于是乎，想到用redis的go client。</p>
<h2 id="直接使用string"><a href="#直接使用string" class="headerlink" title="直接使用string"></a>直接使用string</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line">	&quot;github.com&#x2F;go-redis&#x2F;redis&quot;</span><br><span class="line">	&quot;strconv&quot;</span><br><span class="line">	&quot;time&quot;</span><br><span class="line">)</span><br><span class="line">var redisClient *redis.Client</span><br><span class="line">func init()  &#123;</span><br><span class="line">	var err error</span><br><span class="line">	redisClient&#x3D;redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:&quot;192.168.172.14:6379&quot;,</span><br><span class="line">		Password:&quot;&quot;,</span><br><span class="line">		DB:0,</span><br><span class="line">		PoolSize: 100,</span><br><span class="line">		&#x2F;&#x2F;这个参数必须配置，否则会报超时的错</span><br><span class="line">		WriteTimeout: 300*time.Second,</span><br><span class="line">		ReadTimeout: 300*time.Second,</span><br><span class="line">	&#125;)</span><br><span class="line">	pong,err:&#x3D;redisClient.Ping().Result()</span><br><span class="line">	if err!&#x3D;nil &#123;</span><br><span class="line">		panic(err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(&quot;connect result:&quot;,pong,err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main()&#123;</span><br><span class="line">	fmt.Println(time.Now().Format(&quot;2006-01-02 15:04:00.000&quot;))</span><br><span class="line">	pipe:&#x3D;redisClient.Pipeline()</span><br><span class="line">	for i:&#x3D;0;i&lt;1000000;i++ &#123;</span><br><span class="line">		pipe.Set(&quot;test_&quot;+strconv.Itoa(i),&quot;value_&quot;+strconv.Itoa(i),time.Hour)</span><br><span class="line">	&#125;</span><br><span class="line">	_, err :&#x3D; pipe.Exec()</span><br><span class="line">	if err!&#x3D;nil &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(time.Now().Format(&quot;2006-01-02 15:04:00.000&quot;))</span><br><span class="line">	fmt.Println(redisClient.Dbsize().Val())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="用set集合"><a href="#用set集合" class="headerlink" title="用set集合"></a>用set集合</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import (</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line">	&quot;github.com&#x2F;go-redis&#x2F;redis&quot;</span><br><span class="line">	&quot;strconv&quot;</span><br><span class="line">	&quot;time&quot;</span><br><span class="line">)</span><br><span class="line">var redisClient *redis.Client</span><br><span class="line">func init()  &#123;</span><br><span class="line">	var err error</span><br><span class="line">	redisClient&#x3D;redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:&quot;127.0.0.1:6379&quot;,</span><br><span class="line">		Password:&quot;&quot;,</span><br><span class="line">		DB:0,</span><br><span class="line">		PoolSize: 100,</span><br><span class="line">		WriteTimeout: 300*time.Second,</span><br><span class="line">		ReadTimeout: 300*time.Second,</span><br><span class="line">	&#125;)</span><br><span class="line">	pong,err:&#x3D;redisClient.Ping().Result()</span><br><span class="line">	if err!&#x3D;nil &#123;</span><br><span class="line">		panic(err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(&quot;connect result:&quot;,pong,err)</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main()&#123;</span><br><span class="line">	fmt.Println(time.Now().Format(&quot;2006-01-02 15:04:00.000&quot;))</span><br><span class="line">	pipe:&#x3D;redisClient.Pipeline()</span><br><span class="line">	for i:&#x3D;0;i&lt;2000000;i++ &#123;</span><br><span class="line">		pipe.SAdd(&quot;test&quot;,&quot;value_&quot;+strconv.Itoa(i))</span><br><span class="line">	&#125;</span><br><span class="line">	_, err :&#x3D; pipe.Exec()</span><br><span class="line">	if err!&#x3D;nil &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(time.Now().Format(&quot;2006-01-02 15:04:00.000&quot;))</span><br><span class="line">	fmt.Println(redisClient.SCard(&quot;test&quot;).Val())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jxdw.github.io/2019/08/11/apache_dubbo_zipkin_merge/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/favicon.png">
      <meta itemprop="name" content="渐学顿悟">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渐学顿悟">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/08/11/apache_dubbo_zipkin_merge/" class="post-title-link" itemprop="url">【zipkin/jaeger使用系列】dubbo v2.7.3使用zipkin进行链路监控</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-08-11 11:02:34 11:02:34" itemprop="dateCreated datePublished" datetime="2019-08-11T11:02:34+08:00">2019-08-11 11:02:34</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-13 21:35:07 21:35:07" itemprop="dateModified" datetime="2020-10-13T21:35:07+08:00">2020-10-13 21:35:07</time>
      </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2019/08/11/apache_dubbo_zipkin_merge/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/08/11/apache_dubbo_zipkin_merge/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="本文背景"><a href="#本文背景" class="headerlink" title="本文背景"></a>本文背景</h1><p>因为:<br>1.dubbo已经从apache毕业，而zipkin官方的brave-instrumentation-dubbo-rpc的5.6版本支持的dubbo版本是2.6.6版本、且对2.7.3版本支持不太友好(2.6.6这个版本是未毕业前的版本，不太喜欢），只能把brave-instrumentation-dubbo-rpc抠出来，用以支撑2.7.3版本。<br><br>2.dubbo官方提供的例子还是xml配置版本，现在都9102年了，谁还用XML配置版本。<br><br>因为以上两点，有了此文。</p>
<h1 id="provider方工程代码"><a href="#provider方工程代码" class="headerlink" title="provider方工程代码"></a>provider方工程代码</h1><h2 id="添加pom依赖"><a href="#添加pom依赖" class="headerlink" title="添加pom依赖"></a>添加pom依赖</h2><p>1.brave对dubbo的集成:brave-instrumentation-dubbo-rpc<br>2.brave的spring bean支持:brave-spring-beans<br>3.在SLF4J的MDC(Mapped Diagnostic Context) 中支持 traceId 和 spanId<br>4.使用okhttp3作为 reporter:zipkin-sender-okhttp3<br>当然，最好是同时添加bom，做好版本控制。<br><img src="https://jxdw.github.io/img/devops/zipkin_pom.png"></p>
<h2 id="将TracingFilter扣出来进行改造"><a href="#将TracingFilter扣出来进行改造" class="headerlink" title="将TracingFilter扣出来进行改造"></a>将TracingFilter扣出来进行改造</h2><p>将brave-instrumentation-dubbo-rpc的5.6.6版本的TracingFilter抠出来进行改造，即实现org.apache.dubbo.rpc.Fiter的invoke方法。<br>brave-instrumentation-dubbo-rpc的5.6.6版本的TracingFilter实现的是com.alibaba.dubbo.rpc.Fiter。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">package com.youxia.userinfo.config;</span><br><span class="line"></span><br><span class="line">import brave.Span;</span><br><span class="line">import brave.Tracer;</span><br><span class="line">import brave.Tracing;</span><br><span class="line">import brave.internal.Platform;</span><br><span class="line">import brave.propagation.Propagation;</span><br><span class="line">import brave.propagation.TraceContext;</span><br><span class="line">import brave.propagation.TraceContextOrSamplingFlags;</span><br><span class="line"></span><br><span class="line">import com.alibaba.dubbo.common.Constants;</span><br><span class="line">import com.alibaba.dubbo.remoting.exchange.ResponseCallback;</span><br><span class="line">import com.alibaba.dubbo.rpc.protocol.dubbo.FutureAdapter;</span><br><span class="line">import org.apache.dubbo.common.extension.Activate;</span><br><span class="line">import org.apache.dubbo.rpc.*;</span><br><span class="line"></span><br><span class="line">import org.apache.dubbo.rpc.support.RpcUtils;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import java.net.InetSocketAddress;</span><br><span class="line">import java.util.Map;</span><br><span class="line">import java.util.concurrent.Future;</span><br><span class="line"></span><br><span class="line">@Activate(group &#x3D; &#123;Constants.PROVIDER, Constants.CONSUMER&#125;, value &#x3D; &quot;tracing&quot;)</span><br><span class="line">public final class TracingFilter implements Filter &#123;</span><br><span class="line"></span><br><span class="line">    Tracer tracer;</span><br><span class="line">    TraceContext.Extractor&lt;Map&lt;String, String&gt;&gt; extractor;</span><br><span class="line">    TraceContext.Injector&lt;Map&lt;String, String&gt;&gt; injector;</span><br><span class="line">    volatile boolean isInit &#x3D; false;</span><br><span class="line"></span><br><span class="line">    public void setTracing(Tracing tracing) &#123;</span><br><span class="line">        tracer &#x3D; tracing.tracer();</span><br><span class="line">        extractor &#x3D; tracing.propagation().extractor(GETTER);</span><br><span class="line">        injector &#x3D; tracing.propagation().injector(SETTER);</span><br><span class="line">        isInit &#x3D; true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    static void parseRemoteAddress(RpcContext rpcContext, Span span) &#123;</span><br><span class="line">        InetSocketAddress remoteAddress &#x3D; rpcContext.getRemoteAddress();</span><br><span class="line">        if (remoteAddress &#x3D;&#x3D; null) return;</span><br><span class="line">        span.remoteIpAndPort(Platform.get().getHostString(remoteAddress), remoteAddress.getPort());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    static void onError(Throwable error, Span span) &#123;</span><br><span class="line">        span.error(error);</span><br><span class="line">        if (error instanceof RpcException) &#123;</span><br><span class="line">            span.tag(&quot;userinfo.error_code&quot;, Integer.toString(((RpcException) error).getCode()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    static final Propagation.Getter&lt;Map&lt;String, String&gt;, String&gt; GETTER &#x3D;</span><br><span class="line">            new Propagation.Getter&lt;Map&lt;String, String&gt;, String&gt;() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public String get(Map&lt;String, String&gt; carrier, String key) &#123;</span><br><span class="line">                    return carrier.get(key);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                @Override</span><br><span class="line">                public String toString() &#123;</span><br><span class="line">                    return &quot;Map::get&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">    static final Propagation.Setter&lt;Map&lt;String, String&gt;, String&gt; SETTER &#x3D;</span><br><span class="line">            new Propagation.Setter&lt;Map&lt;String, String&gt;, String&gt;() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public void put(Map&lt;String, String&gt; carrier, String key, String value) &#123;</span><br><span class="line">                    carrier.put(key, value);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                @Override</span><br><span class="line">                public String toString() &#123;</span><br><span class="line">                    return &quot;Map::set&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Result invoke(Invoker&lt;?&gt; invoker, Invocation invocation) throws RpcException &#123;</span><br><span class="line">        if (isInit &#x3D;&#x3D; false) return invoker.invoke(invocation);</span><br><span class="line"></span><br><span class="line">        RpcContext rpcContext &#x3D; RpcContext.getContext();</span><br><span class="line">        Span.Kind kind &#x3D; rpcContext.isProviderSide() ? Span.Kind.SERVER : Span.Kind.CLIENT;</span><br><span class="line">        final Span span;</span><br><span class="line">        if (kind.equals(Span.Kind.CLIENT)) &#123;</span><br><span class="line">            span &#x3D; tracer.nextSpan();</span><br><span class="line">            injector.inject(span.context(), invocation.getAttachments());</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            TraceContextOrSamplingFlags extracted &#x3D; extractor.extract(invocation.getAttachments());</span><br><span class="line">            span &#x3D; extracted.context() !&#x3D; null</span><br><span class="line">                    ? tracer.joinSpan(extracted.context())</span><br><span class="line">                    : tracer.nextSpan(extracted);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (!span.isNoop()) &#123;</span><br><span class="line">            span.kind(kind);</span><br><span class="line">            String service &#x3D; invoker.getInterface().getSimpleName();</span><br><span class="line">            String method &#x3D;RpcUtils.getMethodName(invocation);</span><br><span class="line">            span.name(service + &quot;&#x2F;&quot; + method);</span><br><span class="line">            parseRemoteAddress(rpcContext, span);</span><br><span class="line">            span.start();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        boolean isOneway &#x3D; false, deferFinish &#x3D; false;</span><br><span class="line">        try (Tracer.SpanInScope scope &#x3D; tracer.withSpanInScope(span)) &#123;</span><br><span class="line">            Result result &#x3D; invoker.invoke(invocation);</span><br><span class="line">            if (result.hasException()) &#123;</span><br><span class="line">                onError(result.getException(), span);</span><br><span class="line">            &#125;</span><br><span class="line">            isOneway &#x3D; RpcUtils.isOneway(invoker.getUrl(), invocation);</span><br><span class="line">            Future&lt;Object&gt; future &#x3D; rpcContext.getFuture(); &#x2F;&#x2F; the case on async client invocation</span><br><span class="line">            if (future instanceof FutureAdapter) &#123;</span><br><span class="line">                deferFinish &#x3D; true;</span><br><span class="line">                ((FutureAdapter) future).getFuture().setCallback(new TracingFilter.FinishSpanCallback(span));</span><br><span class="line">            &#125;</span><br><span class="line">            return result;</span><br><span class="line">        &#125; catch (Error | RuntimeException e) &#123;</span><br><span class="line">            onError(e, span);</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            if (isOneway) &#123;</span><br><span class="line">                span.flush();</span><br><span class="line">            &#125; else if (!deferFinish) &#123;</span><br><span class="line">                span.finish();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    static final class FinishSpanCallback implements ResponseCallback &#123;</span><br><span class="line">        final Span span;</span><br><span class="line"></span><br><span class="line">        FinishSpanCallback(Span span) &#123;</span><br><span class="line">            this.span &#x3D; span;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override public void done(Object response) &#123;</span><br><span class="line">            span.finish();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override public void caught(Throwable exception) &#123;</span><br><span class="line">            onError(exception, span);</span><br><span class="line">            span.finish();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="在resource目录增加-META-INF-dubbo-org-apache-dubbo-rpc-Filter文件"><a href="#在resource目录增加-META-INF-dubbo-org-apache-dubbo-rpc-Filter文件" class="headerlink" title="在resource目录增加/META-INF/dubbo/org.apache.dubbo.rpc.Filter文件"></a>在resource目录增加/META-INF/dubbo/org.apache.dubbo.rpc.Filter文件</h2><p>org.apache.dubbo.rpc.Filter文件的内容如下:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tracing&#x3D;com.youxia.userinfo.config.TracingFilter</span><br></pre></td></tr></table></figure>

<h2 id="配置zipkin客户端"><a href="#配置zipkin客户端" class="headerlink" title="配置zipkin客户端"></a>配置zipkin客户端</h2><p>ZipkinConfig内容如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">package com.youxia.userinfo.config;</span><br><span class="line"></span><br><span class="line">import brave.context.slf4j.MDCScopeDecorator;</span><br><span class="line">import brave.propagation.CurrentTraceContext;</span><br><span class="line">import brave.spring.beans.CurrentTraceContextFactoryBean;</span><br><span class="line">import brave.spring.beans.TracingFactoryBean;</span><br><span class="line">import org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line">import org.springframework.beans.factory.annotation.Value;</span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.context.annotation.Configuration;</span><br><span class="line">import zipkin2.codec.SpanBytesEncoder;</span><br><span class="line">import zipkin2.reporter.AsyncReporter;</span><br><span class="line">import zipkin2.reporter.Sender;</span><br><span class="line">import zipkin2.reporter.beans.AsyncReporterFactoryBean;</span><br><span class="line">import zipkin2.reporter.okhttp3.OkHttpSender;</span><br><span class="line"></span><br><span class="line">import java.util.Arrays;</span><br><span class="line">import java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line">@Configuration</span><br><span class="line">public class ZipkinConfig &#123;</span><br><span class="line"></span><br><span class="line">    @Value(&quot;$&#123;zipkin.server.url&#125;&quot;)</span><br><span class="line">    private String ZipkinServerUrl;</span><br><span class="line"></span><br><span class="line">    @Bean(&quot;okHttpSender&quot;)</span><br><span class="line">    public Sender okHttpSender() &#123;</span><br><span class="line">        Sender sender&#x3D; OkHttpSender.create(ZipkinServerUrl);</span><br><span class="line">        return sender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Bean(&quot;reporter&quot;)</span><br><span class="line">    public AsyncReporter getAsyncReporter()&#123;</span><br><span class="line">        AsyncReporter asyncReporter&#x3D;AsyncReporter.builder(okHttpSender()).closeTimeout(50000, TimeUnit.MILLISECONDS).build(SpanBytesEncoder.JSON_V2);</span><br><span class="line">        return asyncReporter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public AsyncReporterFactoryBean reporter(@Qualifier(&quot;okHttpSender&quot;)OkHttpSender sender)&#123;</span><br><span class="line">        AsyncReporterFactoryBean asyncReporterFactoryBean &#x3D; new AsyncReporterFactoryBean();</span><br><span class="line">        asyncReporterFactoryBean.setSender(sender);</span><br><span class="line">        asyncReporterFactoryBean.setCloseTimeout(3000);</span><br><span class="line">        return asyncReporterFactoryBean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public TracingFactoryBean getTracingBean(@Qualifier(&quot;reporter&quot;) AsyncReporter reporter)&#123;</span><br><span class="line">        TracingFactoryBean tracingFactoryBean&#x3D;new TracingFactoryBean();</span><br><span class="line">        tracingFactoryBean.setLocalServiceName(&quot;userinfo-service&quot;);</span><br><span class="line">        CurrentTraceContextFactoryBean currentTraceContextFactoryBean &#x3D; new CurrentTraceContextFactoryBean();</span><br><span class="line">        CurrentTraceContext.ScopeDecorator scopeDecorator &#x3D; MDCScopeDecorator.create();</span><br><span class="line">        currentTraceContextFactoryBean.setScopeDecorators(Arrays.asList(scopeDecorator));</span><br><span class="line">        tracingFactoryBean.setCurrentTraceContext(currentTraceContextFactoryBean.getObject());</span><br><span class="line">        tracingFactoryBean.setSpanReporter(reporter);</span><br><span class="line">        return tracingFactoryBean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="dubbo注解文件添加filter"><a href="#dubbo注解文件添加filter" class="headerlink" title="dubbo注解文件添加filter"></a>dubbo注解文件添加filter</h2><p>业务实现类添加filter：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">package com.youxia.userinfo.service.impl;</span><br><span class="line"></span><br><span class="line">import com.alibaba.dubbo.config.annotation.Service;</span><br><span class="line">import com.youxia.userinfo.domain.User;</span><br><span class="line">import com.youxia.userinfo.service.UserService;</span><br><span class="line"></span><br><span class="line">@Service(filter &#x3D; &#123;&quot;tracing&quot;&#125;)</span><br><span class="line">public class UserServiceImpl implements UserService &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public User saveUser(User user) &#123;</span><br><span class="line">        user.setUserId(1);</span><br><span class="line">        user.setUserName(user.getUserName());</span><br><span class="line">        System.out.println(user.toString());</span><br><span class="line">        return  user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="provider配置文件"><a href="#provider配置文件" class="headerlink" title="provider配置文件"></a>provider配置文件</h2><p>完整的application.properties:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">spring.application.name&#x3D;UserInfoService</span><br><span class="line">server.address&#x3D;10.3.20.57</span><br><span class="line">server.port&#x3D;28081</span><br><span class="line"></span><br><span class="line">dubbo.registry.address&#x3D;redis:&#x2F;&#x2F;192.168.172.4:6380</span><br><span class="line">dubbo.protocol.name&#x3D;dubbo</span><br><span class="line">dubbo.protocol.port&#x3D;28080</span><br><span class="line">dubbo.scan.base-packages&#x3D;com.youxia.userinfo.service</span><br><span class="line">dubbo.application.qos.enable&#x3D;true</span><br><span class="line"></span><br><span class="line">zipkin.server.url&#x3D;http:&#x2F;&#x2F;192.168.172.6:9411&#x2F;api&#x2F;v2&#x2F;spans</span><br></pre></td></tr></table></figure>

<h1 id="consumer工程代码"><a href="#consumer工程代码" class="headerlink" title="consumer工程代码"></a>consumer工程代码</h1><h2 id="业务逻辑处理类代码"><a href="#业务逻辑处理类代码" class="headerlink" title="业务逻辑处理类代码"></a>业务逻辑处理类代码</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">package com.youxia.service.user;</span><br><span class="line"></span><br><span class="line">import com.youxia.userinfo.domain.User;</span><br><span class="line">import com.youxia.userinfo.service.UserService;</span><br><span class="line">import org.apache.dubbo.config.annotation.Reference;</span><br><span class="line">import org.slf4j.Logger;</span><br><span class="line">import org.slf4j.LoggerFactory;</span><br><span class="line">import org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line">@Service</span><br><span class="line">public class UserServiceImpl &#123;</span><br><span class="line">    private static final Logger LOGGER &#x3D; LoggerFactory.getLogger(UserServiceImpl.class);</span><br><span class="line"></span><br><span class="line">    @Reference</span><br><span class="line">    private UserService userService;</span><br><span class="line"></span><br><span class="line">    public User sayHello(User user) &#123;</span><br><span class="line">        return userService.saveUser(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="application-properties文件内容"><a href="#application-properties文件内容" class="headerlink" title="application.properties文件内容"></a>application.properties文件内容</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">server.port&#x3D;28082</span><br><span class="line">server.address&#x3D;10.3.20.57</span><br><span class="line">dubbo.registry.protocol&#x3D;redis</span><br><span class="line">dubbo.registry.address&#x3D;redis:&#x2F;&#x2F;192.168.172.4:6380</span><br><span class="line">dubbo.application.name&#x3D;dubbo-demo-service</span><br><span class="line">dubbo.scan.base-packages&#x3D;com.youxia.service.user</span><br></pre></td></tr></table></figure>

<h1 id="最终效果"><a href="#最终效果" class="headerlink" title="最终效果"></a>最终效果</h1><p><img src="https://jxdw.github.io/img/cloudnative/devops/dubbo_user_info_zipkin.png"></p>
<h1 id="完整代码地址"><a href="#完整代码地址" class="headerlink" title="完整代码地址"></a>完整代码地址</h1><p><a target="_blank" rel="noopener" href="https://github.com/youxia999/spring_boot_service/apache_dubbo_zipkin_project.git">https://github.com/youxia999/spring_boot_service/apache_dubbo_zipkin_project.git</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jxdw.github.io/2019/07/02/golang_viper_config_use/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/favicon.png">
      <meta itemprop="name" content="渐学顿悟">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渐学顿悟">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/07/02/golang_viper_config_use/" class="post-title-link" itemprop="url">【Go框架系列】viper框架的使用</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-07-02 00:08:05 00:08:05" itemprop="dateCreated datePublished" datetime="2019-07-02T00:08:05+08:00">2019-07-02 00:08:05</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-19 23:26:15 23:26:15" itemprop="dateModified" datetime="2020-10-19T23:26:15+08:00">2020-10-19 23:26:15</time>
      </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2019/07/02/golang_viper_config_use/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/07/02/golang_viper_config_use/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line">	&quot;github.com&#x2F;spf13&#x2F;pflag&quot;</span><br><span class="line">	&quot;github.com&#x2F;spf13&#x2F;viper&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	pflag.String(&quot;ip&quot;, &quot;127.0.0.1&quot;, &quot;Server running address&quot;)</span><br><span class="line">	pflag.Int64(&quot;port&quot;, 8080, &quot;Server running port&quot;)</span><br><span class="line">	pflag.Parse()</span><br><span class="line"></span><br><span class="line">	viper.BindPFlags(pflag.CommandLine)</span><br><span class="line">	fmt.Printf(&quot;ip :%s , port:%s&quot;, viper.GetString(&quot;ip&quot;), viper.GetString(&quot;port&quot;))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">go run main.go --ip&#x3D;127.0.0.1 --port&#x3D;8090</span><br></pre></td></tr></table></figure>
<p>运行结果如下</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ip :127.0.0.1 , port:8080</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jxdw.github.io/2019/06/30/cicd-jira-crack-restfulapi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/favicon.png">
      <meta itemprop="name" content="渐学顿悟">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渐学顿悟">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/06/30/cicd-jira-crack-restfulapi/" class="post-title-link" itemprop="url">【jenkins/jira知识体系】【转载】jira7.13版本破解与restful api</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-06-30 19:00:00 19:00:00" itemprop="dateCreated datePublished" datetime="2019-06-30T19:00:00+08:00">2019-06-30 19:00:00</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-13 22:06:21 22:06:21" itemprop="dateModified" datetime="2020-10-13T22:06:21+08:00">2020-10-13 22:06:21</time>
      </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2019/06/30/cicd-jira-crack-restfulapi/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/06/30/cicd-jira-crack-restfulapi/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="jira的restful-api"><a href="#jira的restful-api" class="headerlink" title="jira的restful api"></a>jira的restful api</h1><h2 id="官方参考文档"><a href="#官方参考文档" class="headerlink" title="官方参考文档"></a>官方参考文档</h2><p><a target="_blank" rel="noopener" href="https://docs.atlassian.com/software/jira/docs/api/REST/7.13.0/">https://docs.atlassian.com/software/jira/docs/api/REST/7.13.0/</a></p>
<h2 id="jira的其他参考资料"><a href="#jira的其他参考资料" class="headerlink" title="jira的其他参考资料"></a>jira的其他参考资料</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;blog.csdn.net&#x2F;five3&#x2F;article&#x2F;details&#x2F;7181655</span><br><span class="line">https:&#x2F;&#x2F;blog.csdn.net&#x2F;liumiaocn&#x2F;article&#x2F;details&#x2F;81301550</span><br></pre></td></tr></table></figure>

<h1 id="jira7-13破解"><a href="#jira7-13破解" class="headerlink" title="jira7.13破解"></a>jira7.13破解</h1><p><img src="https://jxdw.github.io/img/devops/cicd/jira-crack.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>





  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



      

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      

      

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">渐学顿悟</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  


















  








  

  

<script>
NexT.utils.loadComments('#valine-comments', () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js', () => {
    new Valine(Object.assign({"enable":true,"appId":"wrre3Nrx21CqKiChLnKn034M-gzGzoHsz","appKey":"rkWWNONo7LAJhlS936vnywQ9","serverURLs":null,"placeholder":"Just go go","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"lang":null,"visitor":false,"comment_count":true,"recordIP":false,"enableQQ":false,"requiredFields":[]}, {
      el: '#valine-comments',
      path: "/page/2/",
      serverURLs: "https://wrre3nrx.api.lncldglobal.com"
    }));
  }, window.Valine);
});
</script>

</body>
</html>
