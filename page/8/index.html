<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.0/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"jxdw.github.io","root":"/","scheme":"Pisces","version":"8.0.1","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12,"width":240},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="渐学顿悟">
<meta property="og:url" content="https://jxdw.github.io/page/8/index.html">
<meta property="og:site_name" content="渐学顿悟">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="渐学顿悟">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://jxdw.github.io/page/8/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>渐学顿悟</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="渐学顿悟" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">渐学顿悟</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">记录技术的学习和实践过程</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">12</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">122</span></a>

  </li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="渐学顿悟"
      src="/favicon.png">
  <p class="site-author-name" itemprop="name">渐学顿悟</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">122</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </section>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">
      

      
    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jxdw.github.io/2018/04/25/golang-standard-lib-for-time/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/favicon.png">
      <meta itemprop="name" content="渐学顿悟">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渐学顿悟">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/04/25/golang-standard-lib-for-time/" class="post-title-link" itemprop="url">【go标准库系列】go标准库之time包</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-04-25 19:17:59 19:17:59" itemprop="dateCreated datePublished" datetime="2018-04-25T19:17:59+08:00">2018-04-25 19:17:59</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-19 23:26:42 23:26:42" itemprop="dateModified" datetime="2020-10-19T23:26:42+08:00">2020-10-19 23:26:42</time>
      </span>

  
    <span id="/2018/04/25/golang-standard-lib-for-time/" class="post-meta-item leancloud_visitors" data-flag-title="【go标准库系列】go标准库之time包" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2018/04/25/golang-standard-lib-for-time/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2018/04/25/golang-standard-lib-for-time/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="直接上源码"><a href="#直接上源码" class="headerlink" title="直接上源码"></a>直接上源码</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line">	&quot;time&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main()&#123;</span><br><span class="line">	now :&#x3D; time.Now().Format(&quot;2006-01-02 15:04:00&quot;)</span><br><span class="line">	fmt.Print(now)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jxdw.github.io/2018/04/14/prometheus-monitor-mysql/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/favicon.png">
      <meta itemprop="name" content="渐学顿悟">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渐学顿悟">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/04/14/prometheus-monitor-mysql/" class="post-title-link" itemprop="url">【prometheus知识体系】(转载)利用Prometheus和Grafana可视化mysql性能</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-04-14 21:39:46 21:39:46" itemprop="dateCreated datePublished" datetime="2018-04-14T21:39:46+08:00">2018-04-14 21:39:46</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-10 23:22:17 23:22:17" itemprop="dateModified" datetime="2020-10-10T23:22:17+08:00">2020-10-10 23:22:17</time>
      </span>

  
    <span id="/2018/04/14/prometheus-monitor-mysql/" class="post-meta-item leancloud_visitors" data-flag-title="【prometheus知识体系】(转载)利用Prometheus和Grafana可视化mysql性能" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2018/04/14/prometheus-monitor-mysql/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2018/04/14/prometheus-monitor-mysql/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="原文地址"><a href="#原文地址" class="headerlink" title="原文地址"></a>原文地址</h1><p><a target="_blank" rel="noopener" href="https://www.percona.com/blog/2016/02/29/graphing-mysql-performance-with-prometheus-and-grafana/">https://www.percona.com/blog/2016/02/29/graphing-mysql-performance-with-prometheus-and-grafana/</a></p>
<h1 id="截图版"><a href="#截图版" class="headerlink" title="截图版"></a>截图版</h1><p><img src="https://jxdw.github.io/img/monitor/MonitorMySQLwithPrometheusandGrafana.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jxdw.github.io/2018/04/01/golang_syntactic_sugar/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/favicon.png">
      <meta itemprop="name" content="渐学顿悟">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渐学顿悟">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/04/01/golang_syntactic_sugar/" class="post-title-link" itemprop="url">【go标准库系列】go语法糖</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-04-01 19:17:59 19:17:59" itemprop="dateCreated datePublished" datetime="2018-04-01T19:17:59+08:00">2018-04-01 19:17:59</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-19 23:27:13 23:27:13" itemprop="dateModified" datetime="2020-10-19T23:27:13+08:00">2020-10-19 23:27:13</time>
      </span>

  
    <span id="/2018/04/01/golang_syntactic_sugar/" class="post-meta-item leancloud_visitors" data-flag-title="【go标准库系列】go语法糖" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2018/04/01/golang_syntactic_sugar/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2018/04/01/golang_syntactic_sugar/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="直接上源码"><a href="#直接上源码" class="headerlink" title="直接上源码"></a>直接上源码</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line">	&quot;time&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main()&#123;</span><br><span class="line">	now :&#x3D; time.Now().Format(&quot;2006-01-02 15:04:00&quot;)</span><br><span class="line">	fmt.Print(now)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jxdw.github.io/2018/03/26/golang_sdk_jiedu/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/favicon.png">
      <meta itemprop="name" content="渐学顿悟">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渐学顿悟">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/03/26/golang_sdk_jiedu/" class="post-title-link" itemprop="url">【go标准库系列】go sdk解读</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-03-26 18:06:47 18:06:47" itemprop="dateCreated datePublished" datetime="2018-03-26T18:06:47+08:00">2018-03-26 18:06:47</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-19 23:26:59 23:26:59" itemprop="dateModified" datetime="2020-10-19T23:26:59+08:00">2020-10-19 23:26:59</time>
      </span>

  
    <span id="/2018/03/26/golang_sdk_jiedu/" class="post-meta-item leancloud_visitors" data-flag-title="【go标准库系列】go sdk解读" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2018/03/26/golang_sdk_jiedu/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2018/03/26/golang_sdk_jiedu/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="https://jxdw.github.io/img/program/go/golang_sdk_jiedu.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jxdw.github.io/2018/02/05/apollo-config-wrapper-install/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/favicon.png">
      <meta itemprop="name" content="渐学顿悟">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渐学顿悟">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/02/05/apollo-config-wrapper-install/" class="post-title-link" itemprop="url">【配置中心知识体系】apollo配置中心wrapper启动</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-02-05 19:54:55 19:54:55" itemprop="dateCreated datePublished" datetime="2018-02-05T19:54:55+08:00">2018-02-05 19:54:55</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-13 22:06:21 22:06:21" itemprop="dateModified" datetime="2020-10-13T22:06:21+08:00">2020-10-13 22:06:21</time>
      </span>

  
    <span id="/2018/02/05/apollo-config-wrapper-install/" class="post-meta-item leancloud_visitors" data-flag-title="【配置中心知识体系】apollo配置中心wrapper启动" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2018/02/05/apollo-config-wrapper-install/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2018/02/05/apollo-config-wrapper-install/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="非官方参考资料"><a href="#非官方参考资料" class="headerlink" title="非官方参考资料"></a>非官方参考资料</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;286.iteye.com&#x2F;blog&#x2F;1915478</span><br></pre></td></tr></table></figure>

<h1 id="本文背景"><a href="#本文背景" class="headerlink" title="本文背景"></a>本文背景</h1><p>几个业务平台的几套环境的配置参数管理很混乱，让有些新进入的小伙伴很混乱，所以，引入配置中心迫在眉睫。</p>
<h1 id="配置中心的部署规划图"><a href="#配置中心的部署规划图" class="headerlink" title="配置中心的部署规划图"></a>配置中心的部署规划图</h1><h2 id="部署ip规划"><a href="#部署ip规划" class="headerlink" title="部署ip规划"></a>部署ip规划</h2><p>configservice+eurekaserver的ip端口：10.2.1.30:8761<br>adminservice的ip端口：10.2.1.30:8762<br>portald的ip端口：10.2.1.30:8763</p>
<p>1.2 账户和路径规划<br>由root创建apolloconfig账号.并创建/data/server/apolloconfig目录、/data/server/logs/apolloconfig目录,并授权给apolloconfig用户。</p>
<p>1.3 配置中心的最终使用<br>使用入口：<a target="_blank" rel="noopener" href="http://10.2.1.30:8763/">http://10.2.1.30:8763/</a><br>注册中心：<a target="_blank" rel="noopener" href="http://10.2.1.30:8761/">http://10.2.1.30:8761/</a></p>
<h1 id="下载github源码打包"><a href="#下载github源码打包" class="headerlink" title="下载github源码打包"></a>下载github源码打包</h1><h2 id="clone源码"><a href="#clone源码" class="headerlink" title="clone源码"></a>clone源码</h2><pre><code>   目前来说，apollo最高版本的v1.1.0，但还是snapshot版本的，因此不建议使用，而源码master分支是对应v1.1版本，这时先切换到v1.0.0的tag.</code></pre>
<h2 id="将项目中的scripts-sql导入脚本到mysql数据库"><a href="#将项目中的scripts-sql导入脚本到mysql数据库" class="headerlink" title="将项目中的scripts/sql导入脚本到mysql数据库"></a>将项目中的scripts/sql导入脚本到mysql数据库</h2><pre><code>  1.打开项目中的scripts/sql文件夹，将apolloconfigdb，apolloportaldb的sql,改成自己想要的数据库名com_apolloconfig_db、com_apolloportal_db。
  2.修改com_apolloconfig_db的serverconfig表的eureka地址为10.2.1.30:8761/eureka
  3.修改com_apolloportal_db的serverconfig表的apollo.portal.envs为fat
    修改com_apolloportal_db的serverconfig表的organizations为[&#123;&quot;orgId&quot;:&quot;XXJYZ&quot;,&quot;orgName&quot;:&quot;**交易组&quot;&#125;,&#123;&quot;orgId&quot;:&quot;YUN&quot;,&quot;orgName&quot;:&quot;**云平台&quot;&#125;]</code></pre>
<h2 id="执行mvn-install-Dmaven-test-skip打包"><a href="#执行mvn-install-Dmaven-test-skip打包" class="headerlink" title="执行mvn install -Dmaven.test.skip打包"></a>执行mvn install -Dmaven.test.skip打包</h2><pre><code>   执行mvn install -Dmaven.test.skip
  分别把target中的apollo-configservice-1.0.0-github.zip，apollo-adminservice-1.0.0-github.zip，apollo-portal-1.0.0-github.zip取出，
  这就是我们即将使用的部署包。</code></pre>
<h1 id="基于wrapper工程完整制作过程"><a href="#基于wrapper工程完整制作过程" class="headerlink" title="基于wrapper工程完整制作过程"></a>基于wrapper工程完整制作过程</h1><h2 id="创建三个wrapper工程adminservice、configservice、portalservice"><a href="#创建三个wrapper工程adminservice、configservice、portalservice" class="headerlink" title="创建三个wrapper工程adminservice、configservice、portalservice"></a>创建三个wrapper工程adminservice、configservice、portalservice</h2><p>   将apollo-adminservice/target/apollo-adminservice-1.0.0-github.zip下的apollo-adminservice-1.0.0.jar放到adminservice的app目录下。<br>   将apollo-configservice/target/apollo-configservice-1.0.0-github.zip下的apollo-configservice-1.0.0.jar放到configservice的app目录下。<br>   将apollo-portal/target/apollo-portal-1.0.0-github.zip下的apollo-portal-1.0.0.jar放到portalservice的app目录下。</p>
<h2 id="配置configservice"><a href="#配置configservice" class="headerlink" title="配置configservice"></a>配置configservice</h2><h3 id="复制源码工程下的配置文件到wrapper工程的conf目录"><a href="#复制源码工程下的配置文件到wrapper工程的conf目录" class="headerlink" title="复制源码工程下的配置文件到wrapper工程的conf目录"></a>复制源码工程下的配置文件到wrapper工程的conf目录</h3><p>   ①复制apollo-configservice\src\main\config的三个文件到configservice的wrapper工程的conf目录<br>   ②apollo-configservice\src\main\resources的4个文件到configservice的wrapper工程的conf目录</p>
<h3 id="修改apolloconfigdb的数据库表serverconfig"><a href="#修改apolloconfigdb的数据库表serverconfig" class="headerlink" title="修改apolloconfigdb的数据库表serverconfig"></a>修改apolloconfigdb的数据库表serverconfig</h3><p>   打开步骤2中创建的com_apolloconfig_db数据库，将serverconfig表中的eureka.service.url配置项改成<a target="_blank" rel="noopener" href="http://10.2.1.30:8897/eureka/">http://10.2.1.30:8897/eureka/</a></p>
<h3 id="修改configservice配置文件"><a href="#修改configservice配置文件" class="headerlink" title="修改configservice配置文件"></a>修改configservice配置文件</h3><ul>
<li>修改bootstrap.yml文件。</li>
<li>修改application-github.properties。将application-github.properties修改为application-fat.properties。并将数据库信息配置成步骤2中建立的com_apolloconfig_db</li>
<li>修改application.yml</li>
<li>修改configservice.properties</li>
<li>修改apollo-configservice.conf文件</li>
<li>修改logback文件</li>
<li>增加wrapper文件</li>
</ul>
<h2 id="配置adminservice"><a href="#配置adminservice" class="headerlink" title="配置adminservice"></a>配置adminservice</h2><h3 id="复制源码工程下的配置文件到wrapper工程的conf目录-1"><a href="#复制源码工程下的配置文件到wrapper工程的conf目录-1" class="headerlink" title="复制源码工程下的配置文件到wrapper工程的conf目录"></a>复制源码工程下的配置文件到wrapper工程的conf目录</h3><ul>
<li>复制apollo-configservice\src\main\config的三个文件到adminservice的wrapper工程的conf目录</li>
<li>复制apollo-configservice\src\main\resources的4个文件到adminservice的wrapper工程的conf目录</li>
</ul>
<h3 id="修改adminservice配置文件"><a href="#修改adminservice配置文件" class="headerlink" title="修改adminservice配置文件"></a>修改adminservice配置文件</h3><ul>
<li>修改bootstrap.yml文件</li>
<li>修改application.yml</li>
<li>修改apollo-configservice.conf文件</li>
<li>修改application-github.properties</li>
<li>修改为application-fat.properties</li>
<li>修改logback.xml文件</li>
<li>增加wrapper相关文件</li>
</ul>
<h2 id="配置portalservice"><a href="#配置portalservice" class="headerlink" title="配置portalservice"></a>配置portalservice</h2><h3 id="复制源码工程下的配置文件到wrapper工程的conf目录-2"><a href="#复制源码工程下的配置文件到wrapper工程的conf目录-2" class="headerlink" title="复制源码工程下的配置文件到wrapper工程的conf目录"></a>复制源码工程下的配置文件到wrapper工程的conf目录</h3><ul>
<li>复制apollo-portal\src\main\config的三个文件到portalservice的wrapper工程的conf目录</li>
<li>复制apollo-portal\src\main\resources的4个文件到portalservice的wrapper工程的conf目录</li>
</ul>
<h3 id="修改portalservice配置文件"><a href="#修改portalservice配置文件" class="headerlink" title="修改portalservice配置文件"></a>修改portalservice配置文件</h3><ul>
<li>修改apollo-env.properties</li>
<li>修改application.yml</li>
<li>apollo-portal.conf</li>
<li>修改application-github.properties。application-github.properties为application-fat.properties,并修改内容</li>
<li>logback文件</li>
<li>新增wrapper相关文件</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jxdw.github.io/2018/01/14/docker-registry-harbor-05-install/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/favicon.png">
      <meta itemprop="name" content="渐学顿悟">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渐学顿悟">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/01/14/docker-registry-harbor-05-install/" class="post-title-link" itemprop="url">【容器知识体系】镜像仓库harbor0.5.0版本安装和使用</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-01-14 22:49:09 22:49:09" itemprop="dateCreated datePublished" datetime="2018-01-14T22:49:09+08:00">2018-01-14 22:49:09</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-13 22:06:38 22:06:38" itemprop="dateModified" datetime="2020-10-13T22:06:38+08:00">2020-10-13 22:06:38</time>
      </span>

  
    <span id="/2018/01/14/docker-registry-harbor-05-install/" class="post-meta-item leancloud_visitors" data-flag-title="【容器知识体系】镜像仓库harbor0.5.0版本安装和使用" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2018/01/14/docker-registry-harbor-05-install/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2018/01/14/docker-registry-harbor-05-install/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="本文背景"><a href="#本文背景" class="headerlink" title="本文背景"></a>本文背景</h1><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>玩docker也差不多一年有余了，但是一直依赖没有一个私有仓库(docker registry没有可视化的界面，一直被我嫌弃)，一直依赖都是在docker hub上面找。没有形成自己的积淀</p>
<h2 id="本文参考资料"><a href="#本文参考资料" class="headerlink" title="本文参考资料"></a>本文参考资料</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/huangjc/p/6266564.html">https://www.cnblogs.com/huangjc/p/6266564.html</a></p>
<h1 id="下载、配置和安装"><a href="#下载、配置和安装" class="headerlink" title="下载、配置和安装"></a>下载、配置和安装</h1><h2 id="下载harbor0-5-0版本离线版"><a href="#下载harbor0-5-0版本离线版" class="headerlink" title="下载harbor0.5.0版本离线版"></a>下载harbor0.5.0版本离线版</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wget https:&#x2F;&#x2F;github.com&#x2F;vmware&#x2F;harbor&#x2F;releases&#x2F;download&#x2F;0.5.0&#x2F;harbor-offline-installer-0.5.0.tgz</span><br></pre></td></tr></table></figure>

<h2 id="下载docker-copose-1-10版本"><a href="#下载docker-copose-1-10版本" class="headerlink" title="下载docker-copose 1.10版本"></a>下载docker-copose 1.10版本</h2><p>下载docker-copose 1.10版本的二进制文件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">curl -L https:&#x2F;&#x2F;github.com&#x2F;docker&#x2F;compose&#x2F;releases&#x2F;download&#x2F;1.10.0&#x2F;docker-compose-&#96;uname -s&#96;-&#96;uname -m&#96; &gt; &#x2F;usr&#x2F;local&#x2F;bin&#x2F;docker-compose</span><br><span class="line">chmod +x &#x2F;usr&#x2F;local&#x2F;bin&#x2F;docker-compose</span><br></pre></td></tr></table></figure>

<h2 id="修改harbor配置"><a href="#修改harbor配置" class="headerlink" title="修改harbor配置"></a>修改harbor配置</h2><p>vim harbor.cfg</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#修改ip</span><br><span class="line">hostname &#x3D; 10.2.1.30</span><br></pre></td></tr></table></figure>
<p>修改docker-compose.yml文件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#暴露registry端口，否则有时会报连接被拒绝</span><br></pre></td></tr></table></figure>

<h2 id="执行-install-sh脚本"><a href="#执行-install-sh脚本" class="headerlink" title="执行./install.sh脚本"></a>执行./install.sh脚本</h2><h2 id="登录查看效果"><a href="#登录查看效果" class="headerlink" title="登录查看效果"></a>登录查看效果</h2>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jxdw.github.io/2017/12/28/spring_boot_dubbo_2.5.8_experience/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/favicon.png">
      <meta itemprop="name" content="渐学顿悟">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渐学顿悟">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/12/28/spring_boot_dubbo_2.5.8_experience/" class="post-title-link" itemprop="url">【java实现微服务架构系列】spring boot与dubbo 2.5.8整合体验</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2017-12-28 14:04:49 14:04:49" itemprop="dateCreated datePublished" datetime="2017-12-28T14:04:49+08:00">2017-12-28 14:04:49</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-13 22:03:37 22:03:37" itemprop="dateModified" datetime="2020-10-13T22:03:37+08:00">2020-10-13 22:03:37</time>
      </span>

  
    <span id="/2017/12/28/spring_boot_dubbo_2.5.8_experience/" class="post-meta-item leancloud_visitors" data-flag-title="【java实现微服务架构系列】spring boot与dubbo 2.5.8整合体验" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2017/12/28/spring_boot_dubbo_2.5.8_experience/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2017/12/28/spring_boot_dubbo_2.5.8_experience/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="本文参考资料"><a href="#本文参考资料" class="headerlink" title="本文参考资料"></a>本文参考资料</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.oschina.net&#x2F;news&#x2F;91565&#x2F;dubbo-2-5-8-released</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jxdw.github.io/2017/12/23/rabbitmq-cluster-install_2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/favicon.png">
      <meta itemprop="name" content="渐学顿悟">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渐学顿悟">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/12/23/rabbitmq-cluster-install_2/" class="post-title-link" itemprop="url">【rabbitmq知识体系】centos7下rabbitmq3.7.2集群配置(续)</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2017-12-23 21:26:52 21:26:52" itemprop="dateCreated datePublished" datetime="2017-12-23T21:26:52+08:00">2017-12-23 21:26:52</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-10 23:11:53 23:11:53" itemprop="dateModified" datetime="2020-10-10T23:11:53+08:00">2020-10-10 23:11:53</time>
      </span>

  
    <span id="/2017/12/23/rabbitmq-cluster-install_2/" class="post-meta-item leancloud_visitors" data-flag-title="【rabbitmq知识体系】centos7下rabbitmq3.7.2集群配置(续)" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2017/12/23/rabbitmq-cluster-install_2/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2017/12/23/rabbitmq-cluster-install_2/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.cnblogs.com&#x2F;me-sa&#x2F;p&#x2F;erlang-epmd.html</span><br></pre></td></tr></table></figure>

<h1 id="erlang虚拟机"><a href="#erlang虚拟机" class="headerlink" title="erlang虚拟机"></a>erlang虚拟机</h1><p>查询官网后得知，rabbitmq是一个基于erlang语言的应用程序。<br>在 Erlang中有两个概念：节点(node)和应用程序(application)。</p>
<h2 id="节点-node"><a href="#节点-node" class="headerlink" title="节点(node)"></a>节点(node)</h2><p>node为运行Erlang虚拟机的一个实例。</p>
<h2 id="应用程序-application"><a href="#应用程序-application" class="headerlink" title="应用程序(application)"></a>应用程序(application)</h2><p>多个Erlang应用程序(application)可以运行在同一个节点(node)之上。</p>
<h2 id="erlang节点特点"><a href="#erlang节点特点" class="headerlink" title="erlang节点特点"></a>erlang节点特点</h2><p>节点(node)之间可进行通信（无论是否运行在同一台服务器)。<br>简单来说：<br>1.一个运行在节点A上的应用程序（application）可以调用节点B上应用程序的方法，就好像调用本地函数一样。<br>2.如果要关闭整个RabbitMQ节点可以使用stop参数，它会和本地节点通信并指示其干净得关闭：/sbin/rabbitmqctl stop。<br>比如：<br>默认node名称是rabbit@server，如果主机名是server.example.com，那么node名称就是 <a href="mailto:&#x72;&#x61;&#x62;&#98;&#105;&#116;&#x40;&#x73;&#101;&#x72;&#x76;&#101;&#114;&#x2e;&#101;&#x78;&#97;&#x6d;&#112;&#108;&#x65;&#x2e;&#x63;&#111;&#x6d;">&#x72;&#x61;&#x62;&#98;&#105;&#116;&#x40;&#x73;&#101;&#x72;&#x76;&#101;&#114;&#x2e;&#101;&#x78;&#97;&#x6d;&#112;&#108;&#x65;&#x2e;&#x63;&#111;&#x6d;</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;sbin&#x2F;rabbitmqctl -n rabbit@server.example.com stop</span><br></pre></td></tr></table></figure>

<p>3.rabbitmqctl关闭RabbitMQ应用程序，如果只想关闭应用程序，同时保持Erlang节点运行则可以使用 stop_app。<br>rabbitmqctl也可以指定关闭不同得节点（包括远程节点），只需传入参数也可以指定关闭不同的节点（包括远程节点），且只需传入参数 -n node(依赖于下面要提到的epmd)。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;sbin&#x2F;rabbitmqctl -n rabbit@server.example.com stop_app</span><br></pre></td></tr></table></figure>

<h2 id="empd"><a href="#empd" class="headerlink" title="empd"></a>empd</h2><p><img src="https://jxdw.github.io/img/business/rabbitmq/rabbitmq_epmd.png"></p>
<h1 id="rabbitmq顶层架构"><a href="#rabbitmq顶层架构" class="headerlink" title="rabbitmq顶层架构"></a>rabbitmq顶层架构</h1><h2 id="集群整体架构"><a href="#集群整体架构" class="headerlink" title="集群整体架构"></a>集群整体架构</h2><p><img src="https://jxdw.github.io/img/business/rabbitmq/rabbit_architecture_1.png"></p>
<h2 id="单点整体架构"><a href="#单点整体架构" class="headerlink" title="单点整体架构"></a>单点整体架构</h2><p><img src="https://jxdw.github.io/img/business/rabbitmq/erlang_application.png"></p>
<h2 id="启动参数解析"><a href="#启动参数解析" class="headerlink" title="启动参数解析"></a>启动参数解析</h2><p>上面提到的整体架构可能有点抽象，看下启动参数</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;usr&#x2F;lib64&#x2F;erlang&#x2F;erts-9.3.3.6&#x2F;bin&#x2F;beam.smp -W w -A 64 </span><br><span class="line">-P 1048576 </span><br><span class="line">-t 5000000 </span><br><span class="line">-stbt db </span><br><span class="line">-zdbbl 128000 </span><br><span class="line">-K true </span><br><span class="line">-- </span><br><span class="line">-root &#x2F;usr&#x2F;lib64&#x2F;erlang  #erlang虚拟机目录</span><br><span class="line">-progname erl </span><br><span class="line">-- </span><br><span class="line">-home &#x2F;var&#x2F;lib&#x2F;rabbitmq #rabbitmq家目录</span><br><span class="line">-- </span><br><span class="line">-pa &#x2F;usr&#x2F;lib&#x2F;rabbitmq&#x2F;lib&#x2F;rabbitmq_server-3.7.2&#x2F;ebin </span><br><span class="line">-noshell</span><br><span class="line">-noinput </span><br><span class="line">-s rabbit boot </span><br><span class="line">-sname rabbit@lxg53 </span><br><span class="line">-boot start_sasl </span><br><span class="line">-conf &#x2F;etc&#x2F;rabbitmq&#x2F;rabbitmq #rabbitmq配置文件</span><br><span class="line">-conf_dir &#x2F;var&#x2F;lib&#x2F;rabbitmq&#x2F;config  #rabbitmq配置文件目录</span><br><span class="line">-conf_script_dir &#x2F;usr&#x2F;lib&#x2F;rabbitmq&#x2F;bin </span><br><span class="line">-conf_schema_dir &#x2F;var&#x2F;lib&#x2F;rabbitmq&#x2F;schema </span><br><span class="line">-kernel inet_default_connect_options [&#123;nodelay,true&#125;] #kerner程序的配置</span><br><span class="line">-sasl errlog_type error </span><br><span class="line">-sasl sasl_error_logger false </span><br><span class="line">-rabbit lager_log_root &quot;&#x2F;data&#x2F;rabbitmq&#x2F;log&quot; #rabbitmq程序的日志配置</span><br><span class="line">-rabbit lager_default_file &quot;&#x2F;data&#x2F;rabbitmq&#x2F;log&#x2F;rabbit@lxg53.log&quot;  #rabbitmq程序的日志配置</span><br><span class="line">-rabbit lager_upgrade_file &quot;&#x2F;data&#x2F;rabbitmq&#x2F;log&#x2F;rabbit@lxg53_upgrade.log&quot;  #rabbitmq程序的日志配置</span><br><span class="line">-rabbit enabled_plugins_file &quot;&#x2F;etc&#x2F;rabbitmq&#x2F;enabled_plugins&quot;  #rabbitmq程序的插件配置</span><br><span class="line">-rabbit plugins_dir &quot;&#x2F;usr&#x2F;lib&#x2F;rabbitmq&#x2F;plugins:&#x2F;usr&#x2F;lib&#x2F;rabbitmq&#x2F;lib&#x2F;rabbitmq_server-3.7.2&#x2F;plugins&quot; #rabbitmq程序的插件目录 </span><br><span class="line">-rabbit plugins_expand_dir &quot;&#x2F;data&#x2F;rabbitmq&#x2F;mnesia&#x2F;rabbit@lxg53-plugins-expand&quot; </span><br><span class="line">-os_mon start_cpu_sup false  #rabbitmq程序的配置</span><br><span class="line">-os_mon start_disksup false </span><br><span class="line">-os_mon start_memsup false </span><br><span class="line">-mnesia dir &quot;&#x2F;data&#x2F;rabbitmq&#x2F;mnesia&#x2F;rabbit@lxg53&quot; </span><br><span class="line">-kernel inet_dist_listen_min 25672 </span><br><span class="line">-kernel inet_dist_listen_max 25672</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmq相关应用程序"><a href="#rabbitmq相关应用程序" class="headerlink" title="rabbitmq相关应用程序"></a>rabbitmq相关应用程序</h2><p>第二种手段：查询日志。<br>结合启动参数、日志后可以看出，rabbitmq相关的erlang程序包括：</p>
<ul>
<li>rabbitmq_management</li>
<li>amqp_client</li>
<li>rabbitmq_web_dispatch</li>
<li>cowboy #http server</li>
<li>cowlib</li>
<li>rabbitmq_management_agent #基于cowboy的插件</li>
<li>rabbit</li>
<li>mnesia</li>
<li>rabbit_common</li>
<li>os_mon<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2017-12-23 13:21:40.187 [info] &lt;0.18635.0&gt; RabbitMQ is asked to stop...</span><br><span class="line">2017-12-23 13:21:40.410 [info] &lt;0.18635.0&gt; Stopping RabbitMQ applications and their dependencies in the following order:</span><br><span class="line">    rabbitmq_management</span><br><span class="line">    amqp_client</span><br><span class="line">    rabbitmq_web_dispatch</span><br><span class="line">    cowboy</span><br><span class="line">    cowlib</span><br><span class="line">    rabbitmq_management_agent</span><br><span class="line">    rabbit</span><br><span class="line">    mnesia</span><br><span class="line">    rabbit_common</span><br><span class="line">    os_mon</span><br><span class="line">2017-12-23 13:21:40.410 [info] &lt;0.18635.0&gt; Stopping application &#39;rabbitmq_management&#39;</span><br><span class="line">2017-12-23 13:21:40.414 [info] &lt;0.33.0&gt; Application rabbitmq_management exited with reason: stopped</span><br><span class="line">2017-12-23 13:21:40.414 [info] &lt;0.18635.0&gt; Stopping application &#39;amqp_client&#39;</span><br><span class="line">2017-12-23 13:21:40.416 [info] &lt;0.33.0&gt; Application amqp_client exited with reason: stopped</span><br><span class="line">2017-12-23 13:21:40.416 [info] &lt;0.18635.0&gt; Stopping application &#39;rabbitmq_web_dispatch&#39;</span><br><span class="line">2017-12-23 13:21:40.419 [info] &lt;0.33.0&gt; Application rabbitmq_web_dispatch exited with reason: stopped</span><br><span class="line">2017-12-23 13:21:40.419 [info] &lt;0.18635.0&gt; Stopping application &#39;cowboy&#39;</span><br><span class="line">2017-12-23 13:21:40.421 [info] &lt;0.33.0&gt; Application cowboy exited with reason: stopped</span><br><span class="line">2017-12-23 13:21:40.421 [info] &lt;0.18635.0&gt; Stopping application &#39;cowlib&#39;</span><br><span class="line">2017-12-23 13:21:40.421 [info] &lt;0.33.0&gt; Application cowlib exited with reason: stopped</span><br><span class="line">2017-12-23 13:21:40.421 [info] &lt;0.18635.0&gt; Stopping application &#39;rabbitmq_management_agent&#39;</span><br><span class="line">2017-12-23 13:21:40.424 [info] &lt;0.33.0&gt; Application rabbitmq_management_agent exited with reason: stopped</span><br><span class="line">2017-12-23 13:21:40.424 [info] &lt;0.18635.0&gt; Stopping application &#39;rabbit&#39;</span><br><span class="line">2017-12-23 13:21:40.424 [info] &lt;0.944.0&gt; Peer discovery backend rabbit_peer_discovery_classic_config does not support registration, skipping unregistration.</span><br><span class="line">2017-12-23 13:21:40.424 [info] &lt;0.1300.0&gt; stopped TCP Listener on [::]:5672</span><br><span class="line">2017-12-23 13:21:40.425 [info] &lt;0.1039.0&gt; Closing all connections in vhost &#39;bbs&#39; on node &#39;rabbit@lxg54&#39; because the vhost is stopping</span><br><span class="line">2017-12-23 13:21:40.426 [info] &lt;0.1039.0&gt; Closing all connections in vhost &#39;fsp_metrics&#39; on node &#39;rabbit@lxg54&#39; because the vhost is stopping</span><br><span class="line">2017-12-23 13:21:40.426 [info] &lt;0.1236.0&gt; Stopping message store for directory &#39;&#x2F;var&#x2F;lib&#x2F;rabbitmq&#x2F;mnesia&#x2F;rabbit@lxg54&#x2F;msg_stores&#x2F;vhosts&#x2F;2EO163IWD87C0LGDYBMCOU9AZ&#x2F;msg_store_persistent&#39;</span><br><span class="line">2017-12-23 13:21:40.426 [info] &lt;0.1183.0&gt; Stopping message store for directory &#39;&#x2F;var&#x2F;lib&#x2F;rabbitmq&#x2F;mnesia&#x2F;rabbit@lxg54&#x2F;msg_stores&#x2F;vhosts&#x2F;CJ961M2R0VKA2HG0XCI215CBA&#x2F;msg_store_persistent&#39;</span><br><span class="line">2017-12-23 13:21:40.426 [info] &lt;0.1130.0&gt; Stopping message store for directory &#39;&#x2F;var&#x2F;lib&#x2F;rabbitmq&#x2F;mnesia&#x2F;rabbit@lxg54&#x2F;msg_stores&#x2F;vhosts&#x2F;628WB79CIFDYO9LJI6DKMI09L&#x2F;msg_store_persistent&#39;</span><br><span class="line">2017-12-23 13:21:40.426 [info] &lt;0.1077.0&gt; Stopping message store for directory &#39;&#x2F;var&#x2F;lib&#x2F;rabbitmq&#x2F;mnesia&#x2F;rabbit@lxg54&#x2F;msg_stores&#x2F;vhosts&#x2F;BILT8EMIAEYFVG7TLIG4764T5&#x2F;msg_store_persistent&#39;</span><br><span class="line">2017-12-23 13:21:40.426 [info] &lt;0.1039.0&gt; Closing all connections in vhost &#39;&#x2F;&#39; on node &#39;rabbit@lxg54&#39; because the vhost is stopping</span><br><span class="line">2017-12-23 13:21:40.426 [info] &lt;0.1039.0&gt; Closing all connections in vhost &#39;fsp-asynctask-service&#39; on node &#39;rabbit@lxg54&#39; because the vhost is stopping</span><br><span class="line">2017-12-23 13:21:40.482 [info] &lt;0.1130.0&gt; Message store for directory &#39;&#x2F;var&#x2F;lib&#x2F;rabbitmq&#x2F;mnesia&#x2F;rabbit@lxg54&#x2F;msg_stores&#x2F;vhosts&#x2F;628WB79CIFDYO9LJI6DKMI09L&#x2F;msg_store_persistent&#39; is stopped</span><br><span class="line">2017-12-23 13:21:40.482 [info] &lt;0.1127.0&gt; Stopping message store for directory &#39;&#x2F;var&#x2F;lib&#x2F;rabbitmq&#x2F;mnesia&#x2F;rabbit@lxg54&#x2F;msg_stores&#x2F;vhosts&#x2F;628WB79CIFDYO9LJI6DKMI09L&#x2F;msg_store_transient&#39;</span><br><span class="line">2017-12-23 13:21:40.483 [info] &lt;0.1236.0&gt; Message store for directory &#39;&#x2F;var&#x2F;lib&#x2F;rabbitmq&#x2F;mnesia&#x2F;rabbit@lxg54&#x2F;msg_stores&#x2F;vhosts&#x2F;2EO163IWD87C0LGDYBMCOU9AZ&#x2F;msg_store_persistent&#39; is stopped</span><br><span class="line">2017-12-23 13:21:40.483 [info] &lt;0.1077.0&gt; Message store for directory &#39;&#x2F;var&#x2F;lib&#x2F;rabbitmq&#x2F;mnesia&#x2F;rabbit@lxg54&#x2F;msg_stores&#x2F;vhosts&#x2F;BILT8EMIAEYFVG7TLIG4764T5&#x2F;msg_store_persistent&#39; is stopped</span><br><span class="line">2017-12-23 13:21:40.483 [info] &lt;0.1183.0&gt; Message store for directory &#39;&#x2F;var&#x2F;lib&#x2F;rabbitmq&#x2F;mnesia&#x2F;rabbit@lxg54&#x2F;msg_stores&#x2F;vhosts&#x2F;CJ961M2R0VKA2HG0XCI215CBA&#x2F;msg_store_persistent&#39; is stopped</span><br><span class="line">2017-12-23 13:21:40.483 [info] &lt;0.1074.0&gt; Stopping message store for directory &#39;&#x2F;var&#x2F;lib&#x2F;rabbitmq&#x2F;mnesia&#x2F;rabbit@lxg54&#x2F;msg_stores&#x2F;vhosts&#x2F;BILT8EMIAEYFVG7TLIG4764T5&#x2F;msg_store_transient&#39;</span><br><span class="line">2017-12-23 13:21:40.483 [info] &lt;0.1233.0&gt; Stopping message store for directory &#39;&#x2F;var&#x2F;lib&#x2F;rabbitmq&#x2F;mnesia&#x2F;rabbit@lxg54&#x2F;msg_stores&#x2F;vhosts&#x2F;2EO163IWD87C0LGDYBMCOU9AZ&#x2F;msg_store_transient&#39;</span><br><span class="line">2017-12-23 13:21:40.483 [info] &lt;0.1180.0&gt; Stopping message store for directory &#39;&#x2F;var&#x2F;lib&#x2F;rabbitmq&#x2F;mnesia&#x2F;rabbit@lxg54&#x2F;msg_stores&#x2F;vhosts&#x2F;CJ961M2R0VKA2HG0XCI215CBA&#x2F;msg_store_transient&#39;</span><br><span class="line">2017-12-23 13:21:40.626 [info] &lt;0.1127.0&gt; Message store for directory &#39;&#x2F;var&#x2F;lib&#x2F;rabbitmq&#x2F;mnesia&#x2F;rabbit@lxg54&#x2F;msg_stores&#x2F;vhosts&#x2F;628WB79CIFDYO9LJI6DKMI09L&#x2F;msg_store_transient&#39; is stopped</span><br><span class="line">2017-12-23 13:21:40.626 [info] &lt;0.1233.0&gt; Message store for directory &#39;&#x2F;var&#x2F;lib&#x2F;rabbitmq&#x2F;mnesia&#x2F;rabbit@lxg54&#x2F;msg_stores&#x2F;vhosts&#x2F;2EO163IWD87C0LGDYBMCOU9AZ&#x2F;msg_store_transient&#39; is stopped</span><br><span class="line">2017-12-23 13:21:40.626 [info] &lt;0.1180.0&gt; Message store for directory &#39;&#x2F;var&#x2F;lib&#x2F;rabbitmq&#x2F;mnesia&#x2F;rabbit@lxg54&#x2F;msg_stores&#x2F;vhosts&#x2F;CJ961M2R0VKA2HG0XCI215CBA&#x2F;msg_store_transient&#39; is stopped</span><br><span class="line">2017-12-23 13:21:40.627 [info] &lt;0.1074.0&gt; Message store for directory &#39;&#x2F;var&#x2F;lib&#x2F;rabbitmq&#x2F;mnesia&#x2F;rabbit@lxg54&#x2F;msg_stores&#x2F;vhosts&#x2F;BILT8EMIAEYFVG7TLIG4764T5&#x2F;msg_store_transient&#39; is stopped</span><br><span class="line">2017-12-23 13:21:40.631 [info] &lt;0.18635.0&gt; Stopping application &#39;mnesia&#39;</span><br><span class="line">2017-12-23 13:21:40.631 [info] &lt;0.33.0&gt; Application rabbit exited with reason: stopped</span><br><span class="line">2017-12-23 13:21:40.634 [info] &lt;0.33.0&gt; Application mnesia exited with reason: stopped</span><br><span class="line">2017-12-23 13:21:40.634 [info] &lt;0.18635.0&gt; Stopping application &#39;rabbit_common&#39;</span><br><span class="line">2017-12-23 13:21:40.634 [info] &lt;0.33.0&gt; Application rabbit_common exited with reason: stopped</span><br><span class="line">2017-12-23 13:21:40.634 [info] &lt;0.18635.0&gt; Stopping application &#39;os_mon&#39;</span><br><span class="line">2017-12-23 13:21:40.636 [info] &lt;0.33.0&gt; Application os_mon exited with reason: stopped</span><br><span class="line">2017-12-23 13:21:40.636 [info] &lt;0.18635.0&gt; Successfully stopped RabbitMQ and its dependencies</span><br></pre></td></tr></table></figure>


</li>
</ul>
<h1 id="rabbitmq核心概念"><a href="#rabbitmq核心概念" class="headerlink" title="rabbitmq核心概念"></a>rabbitmq核心概念</h1><h2 id="Broker"><a href="#Broker" class="headerlink" title="Broker"></a>Broker</h2><p>简单来说就是消息队列服务器的实体，类似于 JMS 规范中的 JMS provider。它用于接收和分发消息，有时候也称为 Message Broker 或者更直白的称为 RabbitMQ Server。</p>
<h2 id="cluster"><a href="#cluster" class="headerlink" title="cluster"></a>cluster</h2><p>一群broker组成的集群，其中一个是disc节点，其他的为ram节点。</p>
<h2 id="Virtual-Host"><a href="#Virtual-Host" class="headerlink" title="Virtual Host"></a>Virtual Host</h2><p>和 Web 服务器中的虚拟主机（Virtual Host）是类似的概念，出于多租户和安全因素设计的，可以将 RabbitMQ Server 划分成多个独立的空间，彼此之间互相独立，这样就可以将一个 RabbitMQ Server 同时提供给多个用户使用，每个用户在自己的空间内创建 Exchange 和 Queue。</p>
<h2 id="Exchange"><a href="#Exchange" class="headerlink" title="Exchange"></a>Exchange</h2><p>交换机用于接收消息，这是消息到达 Broker 的第一站，然后根据交换机的类型和路由规则（Routing Key），将消息分发到特定的队列中去。常用的交换机类型有：direct (point-to-point)、topic (publish-subscribe) 和 fanout (multicast)。</p>
<h2 id="Queue"><a href="#Queue" class="headerlink" title="Queue"></a>Queue</h2><p>生产者发送的消息就是存储在这里，在 JMS 规范里，没有 Exchange 的概念，消息是直接发送到 Queue，而在 AMQP 中，消息会经过 Exchange，由 Exchange 来将消息分发到各个队列中。消费者可以直接从这里取走消息。</p>
<h2 id="Binding"><a href="#Binding" class="headerlink" title="Binding"></a>Binding</h2><p>绑定的作用就是把 Exchange 和 Queue 按照路由规则绑定起来，路由规则可由下面的 Routing Key 指定。</p>
<h2 id="Routing-Key"><a href="#Routing-Key" class="headerlink" title="Routing Key"></a>Routing Key</h2><p>路由关键字，Exchange 根据这个关键字进行消息投递。</p>
<h2 id="Producer-Publisher"><a href="#Producer-Publisher" class="headerlink" title="Producer/Publisher"></a>Producer/Publisher</h2><p>消息生产者或发布者，产生消息的程序。</p>
<h2 id="Consumer-Subscriber"><a href="#Consumer-Subscriber" class="headerlink" title="Consumer/Subscriber"></a>Consumer/Subscriber</h2><p>消息消费者或订阅者，接收消息的程序。</p>
<h2 id="Connection"><a href="#Connection" class="headerlink" title="Connection"></a>Connection</h2><p>生产者和消费者和 Broker 之间的连接，一个 Connection 实际上就对应着一条 TCP 连接。</p>
<h2 id="Channel"><a href="#Channel" class="headerlink" title="Channel"></a>Channel</h2><p>由于 TCP 连接的创建和关闭开销非常大，如果每次访问 Broker 都建立一个 Connection，在消息量大的时候效率会非常低。Channel 是在 Connection 内部建立的逻辑连接，相当于一次会话，如果应用程序支持多线程，通常每个线程都会创建一个单独的 Channel 进行通讯，各个 Channel 之间完全隔离，但这些 Channel 可以公用一个 Connection。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jxdw.github.io/2017/12/23/rabbitmq-cluster-install/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/favicon.png">
      <meta itemprop="name" content="渐学顿悟">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渐学顿悟">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/12/23/rabbitmq-cluster-install/" class="post-title-link" itemprop="url">【rabbitmq知识体系】centos7下rabbitmq3.7.2集群配置</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2017-12-23 19:30:54 19:30:54" itemprop="dateCreated datePublished" datetime="2017-12-23T19:30:54+08:00">2017-12-23 19:30:54</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-10 23:11:44 23:11:44" itemprop="dateModified" datetime="2020-10-10T23:11:44+08:00">2020-10-10 23:11:44</time>
      </span>

  
    <span id="/2017/12/23/rabbitmq-cluster-install/" class="post-meta-item leancloud_visitors" data-flag-title="【rabbitmq知识体系】centos7下rabbitmq3.7.2集群配置" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2017/12/23/rabbitmq-cluster-install/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2017/12/23/rabbitmq-cluster-install/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="参考资料和更新历史"><a href="#参考资料和更新历史" class="headerlink" title="参考资料和更新历史"></a>参考资料和更新历史</h1><h2 id="本文参考资料"><a href="#本文参考资料" class="headerlink" title="本文参考资料"></a>本文参考资料</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;www.cnblogs.com&#x2F;luxiaoxun&#x2F;p&#x2F;3918054.html</span><br><span class="line">https:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;518a504fe2cc</span><br><span class="line">https:&#x2F;&#x2F;www.rabbitmq.com&#x2F;changelog.html</span><br><span class="line">http:&#x2F;&#x2F;blog.didispace.com&#x2F;spring-boot-rabbitmq&#x2F;</span><br><span class="line">https:&#x2F;&#x2F;blog.csdn.net&#x2F;zyz511919766&#x2F;article&#x2F;details&#x2F;41896747</span><br><span class="line">https:&#x2F;&#x2F;www.rabbitmq.com&#x2F;configure.html</span><br><span class="line">https:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;b6bdd6f56f9c</span><br></pre></td></tr></table></figure>

<h2 id="文章更新历史"><a href="#文章更新历史" class="headerlink" title="文章更新历史"></a>文章更新历史</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2017-12-23 19:30:54 初稿</span><br><span class="line">2019-04-29 20:30:54 因为erlang的rpm包被移走了，需要更新repo文件</span><br></pre></td></tr></table></figure>
<p><img src="https://jxdw.github.io/img/business/rabbitmq/rabbitmq_erlang.png"></p>
<h1 id="部署规划"><a href="#部署规划" class="headerlink" title="部署规划"></a>部署规划</h1><h2 id="集群所有机器增加hosts"><a href="#集群所有机器增加hosts" class="headerlink" title="集群所有机器增加hosts"></a>集群所有机器增加hosts</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">10.2.1.53 lxg53</span><br><span class="line">10.2.1.54 lxg54</span><br><span class="line">10.2.1.55 lxg55</span><br></pre></td></tr></table></figure>

<h2 id="目录规划"><a href="#目录规划" class="headerlink" title="目录规划"></a>目录规划</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">配置文件目录:&#x2F;etc&#x2F;rabbitmq&#x2F;</span><br><span class="line">主要工作目录:&#x2F;var&#x2F;lib&#x2F;rabbitmq</span><br><span class="line">日志文件目录:&#x2F;data&#x2F;rabbitmq&#x2F;log</span><br><span class="line">数据库目录：&#x2F;data&#x2F;rabbitmq&#x2F;mnesia&#x2F;rabbit@lxg53</span><br></pre></td></tr></table></figure>
<p><img src="https://jxdw.github.io/img/business/rabbitmq/rabbitmq_cluster_lxg53.png"><br><img src="https://jxdw.github.io/img/business/rabbitmq/rabbitmq_cluster_lxg54.png"><br><img src="https://jxdw.github.io/img/business/rabbitmq/rabbitmq_cluster_lxg55.png"><br>ps:真的很讨厌程序的工作目录放在/var/lib目录下（这是系统盘下，如果系统盘符小，分分钟撑爆系统盘符）。<br>但是目前也没有找到有效的办法，修改工作目录。</p>
<h1 id="安装erlang与rabbit-server集群"><a href="#安装erlang与rabbit-server集群" class="headerlink" title="安装erlang与rabbit-server集群"></a>安装erlang与rabbit-server集群</h1><h2 id="更新curl程序"><a href="#更新curl程序" class="headerlink" title="更新curl程序"></a>更新curl程序</h2><p>yum update nss curl</p>
<h2 id="更新erlang的repo"><a href="#更新erlang的repo" class="headerlink" title="更新erlang的repo"></a>更新erlang的repo</h2><p>vim /etc/yum.repos.d/rabbitmq-erlang.repo</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[rabbitmq-erlang]</span><br><span class="line">name&#x3D;rabbitmq-erlang</span><br><span class="line">baseurl&#x3D;https:&#x2F;&#x2F;dl.bintray.com&#x2F;rabbitmq-erlang&#x2F;rpm&#x2F;erlang&#x2F;20&#x2F;el&#x2F;7</span><br><span class="line">gpgcheck&#x3D;1</span><br><span class="line">gpgkey&#x3D;https:&#x2F;&#x2F;dl.bintray.com&#x2F;rabbitmq&#x2F;Keys&#x2F;rabbitmq-release-signing-key.asc</span><br><span class="line">repo_gpgcheck&#x3D;0</span><br><span class="line">enabled&#x3D;1</span><br></pre></td></tr></table></figure>

<h2 id="安装erlang"><a href="#安装erlang" class="headerlink" title="安装erlang"></a>安装erlang</h2><p>yum install erlang</p>
<h2 id="安装rabbitmq-server"><a href="#安装rabbitmq-server" class="headerlink" title="安装rabbitmq-server"></a>安装rabbitmq-server</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wget https:&#x2F;&#x2F;dl.bintray.com&#x2F;rabbitmq&#x2F;all&#x2F;rabbitmq-server&#x2F;3.7.2&#x2F;rabbitmq-server-3.7.2-1.el7.noarch.rpm</span><br><span class="line">rpm --import https:&#x2F;&#x2F;dl.bintray.com&#x2F;rabbitmq&#x2F;Keys&#x2F;rabbitmq-release-signing-key.asc</span><br><span class="line">yum install rabbitmq-server-3.7.2-1.el7.noarch.rpm</span><br></pre></td></tr></table></figure>
<h2 id="修改rabbitmq配置"><a href="#修改rabbitmq配置" class="headerlink" title="修改rabbitmq配置"></a>修改rabbitmq配置</h2><h3 id="配置文件位置"><a href="#配置文件位置" class="headerlink" title="配置文件位置"></a>配置文件位置</h3><p><img src="https://jxdw.github.io/img/business/rabbitmq/rabbitmq_conf_file_location.png"><br>rabbit3.7之后，采用了rabbitmq.conf、rabbitmq-env.conf。（网上很多照抄的说，从3.7开始命名叫rabbitmq.config，看着蛋疼）<br><img src="https://jxdw.github.io/img/business/rabbitmq/rabbitmq_configuration.png"></p>
<h3 id="rabbitmq-conf"><a href="#rabbitmq-conf" class="headerlink" title="rabbitmq.conf"></a>rabbitmq.conf</h3><p><img src="https://jxdw.github.io/img/business/rabbitmq/rabbitmq_conf.png"></p>
<h3 id="rabbitmq-env-conf"><a href="#rabbitmq-env-conf" class="headerlink" title="rabbitmq-env.conf"></a>rabbitmq-env.conf</h3><p><img src="https://jxdw.github.io/img/business/rabbitmq/rabbitmq_env_conf.png"></p>
<h2 id="启动rabbitmq主节点和插件"><a href="#启动rabbitmq主节点和插件" class="headerlink" title="启动rabbitmq主节点和插件"></a>启动rabbitmq主节点和插件</h2><h3 id="创建目录及启动rabbit-server"><a href="#创建目录及启动rabbit-server" class="headerlink" title="创建目录及启动rabbit-server"></a>创建目录及启动rabbit-server</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">chown -R rabbitmq:rabbitmq &#x2F;var&#x2F;lib&#x2F;rabbitmq&#x2F;</span><br><span class="line">mkdir -p data&#x2F;rabbitmq&#x2F;log</span><br><span class="line">mkdir -p &#x2F;data&#x2F;rabbitmq&#x2F;mnesia</span><br><span class="line">chown -R rabbitmq:rabbitmq &#x2F;data&#x2F;rabbitmq&#x2F;</span><br><span class="line">systemctl start rabbitmq-server</span><br></pre></td></tr></table></figure>

<h3 id="启用插件授权登录"><a href="#启用插件授权登录" class="headerlink" title="启用插件授权登录"></a>启用插件授权登录</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rabbitmq-plugins enable rabbitmq_management</span><br><span class="line">rabbitmqctl add_user admin admin</span><br><span class="line">rabbitmqctl set_user_tags admin administrator</span><br><span class="line">rabbitmqctl set_permissions -p &#x2F; admin &quot;.*&quot; &quot;.*&quot; &quot;.*&quot;</span><br><span class="line">rabbitmqctl status</span><br></pre></td></tr></table></figure>

<h3 id="其他的插件"><a href="#其他的插件" class="headerlink" title="其他的插件"></a>其他的插件</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rabbitmq-plugins enable rabbitmq_mqtt</span><br><span class="line">rabbitmq-plugins enable rabbitmq_stomp</span><br><span class="line">rabbitmq-plugins enable rabbitmq_web_mqtt</span><br><span class="line">rabbitmq-plugins enable rabbitmq_web_stomp</span><br></pre></td></tr></table></figure>

<h2 id="同步cookie和启动从节点"><a href="#同步cookie和启动从节点" class="headerlink" title="同步cookie和启动从节点"></a>同步cookie和启动从节点</h2><h3 id="同步cookie到从节点"><a href="#同步cookie到从节点" class="headerlink" title="同步cookie到从节点"></a>同步cookie到从节点</h3><p>cat /var/lib/rabbitmq/.erlang.cookie</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">DSXSMAIWGQYIUAALJXQH</span><br></pre></td></tr></table></figure>
<p>nc到从节点的/var/lib/rabbitmq/目录。</p>
<h3 id="启动从节点"><a href="#启动从节点" class="headerlink" title="启动从节点"></a>启动从节点</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">systemctl start rabbitmq-server</span><br><span class="line">rabbitmq-plugins enable rabbitmq_management</span><br><span class="line">rabbitmqctl add_user admin admin</span><br><span class="line">rabbitmqctl set_user_tags admin administrator</span><br><span class="line">rabbitmqctl set_permissions -p &#x2F; admin &quot;.*&quot; &quot;.*&quot; &quot;.*&quot;</span><br><span class="line">rabbitmqctl stop_app</span><br><span class="line">rabbitmqctl reset</span><br></pre></td></tr></table></figure>

<h3 id="从节点加入到集群"><a href="#从节点加入到集群" class="headerlink" title="从节点加入到集群"></a>从节点加入到集群</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rabbitmqctl join_cluster --ram rabbit@lxg53</span><br><span class="line">rabbitmqctl start_app</span><br></pre></td></tr></table></figure>

<h3 id="某个从节点重启"><a href="#某个从节点重启" class="headerlink" title="某个从节点重启"></a>某个从节点重启</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">systemctl start rabbitmq-server</span><br><span class="line">rabbitmqctl stop_app</span><br><span class="line">rabbitmqctl start_app</span><br></pre></td></tr></table></figure>

<h2 id="镜像队列"><a href="#镜像队列" class="headerlink" title="镜像队列"></a>镜像队列</h2><h1 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h1><h2 id="负载均衡-1"><a href="#负载均衡-1" class="headerlink" title="负载均衡"></a>负载均衡</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#---------------------------------------------------------------------</span><br><span class="line"># Example configuration for a possible web application.  See the</span><br><span class="line"># full configuration options online.</span><br><span class="line">#</span><br><span class="line">#   http:&#x2F;&#x2F;haproxy.1wt.eu&#x2F;download&#x2F;1.4&#x2F;doc&#x2F;configuration.txt</span><br><span class="line">#</span><br><span class="line">#---------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">#---------------------------------------------------------------------</span><br><span class="line"># Global settings</span><br><span class="line">#---------------------------------------------------------------------</span><br><span class="line">global</span><br><span class="line">    # to have these messages end up in &#x2F;var&#x2F;log&#x2F;haproxy.log you will</span><br><span class="line">    # need to:</span><br><span class="line">    #</span><br><span class="line">    # 1) configure syslog to accept network log events.  This is done</span><br><span class="line">    #    by adding the &#39;-r&#39; option to the SYSLOGD_OPTIONS in</span><br><span class="line">    #    &#x2F;etc&#x2F;sysconfig&#x2F;syslog</span><br><span class="line">    #</span><br><span class="line">    # 2) configure local2 events to go to the &#x2F;var&#x2F;log&#x2F;haproxy.log</span><br><span class="line">    #   file. A line like the following can be added to</span><br><span class="line">    #   &#x2F;etc&#x2F;sysconfig&#x2F;syslog</span><br><span class="line">    #</span><br><span class="line">    #    local2.*                       &#x2F;var&#x2F;log&#x2F;haproxy.log</span><br><span class="line">    #</span><br><span class="line">    log         127.0.0.1 local0 info</span><br><span class="line">    chroot      &#x2F;var&#x2F;lib&#x2F;haproxy</span><br><span class="line">    pidfile     &#x2F;var&#x2F;run&#x2F;haproxy.pid</span><br><span class="line">    maxconn     4000</span><br><span class="line">    user        haproxy</span><br><span class="line">    group       haproxy</span><br><span class="line">    daemon</span><br><span class="line"></span><br><span class="line">    # turn on stats unix socket</span><br><span class="line">    stats socket &#x2F;var&#x2F;lib&#x2F;haproxy&#x2F;stats</span><br><span class="line"></span><br><span class="line">#---------------------------------------------------------------------</span><br><span class="line"># common defaults that all the &#39;listen&#39; and &#39;backend&#39; sections will</span><br><span class="line"># use if not designated in their block</span><br><span class="line">#---------------------------------------------------------------------</span><br><span class="line">defaults</span><br><span class="line">    mode                    http</span><br><span class="line">    log                     global</span><br><span class="line">    option                  httplog</span><br><span class="line">    option                  dontlognull</span><br><span class="line">    option http-server-close</span><br><span class="line">    option forwardfor       except 127.0.0.0&#x2F;8</span><br><span class="line">    option                  redispatch</span><br><span class="line">    retries                 3</span><br><span class="line">    timeout http-request    10s</span><br><span class="line">    timeout queue           1m</span><br><span class="line">    timeout connect         10s</span><br><span class="line">    timeout client          1m</span><br><span class="line">    timeout server          1m</span><br><span class="line">    timeout http-keep-alive 10s</span><br><span class="line">    timeout check           10s</span><br><span class="line">    maxconn                 3000</span><br><span class="line"></span><br><span class="line">listen status</span><br><span class="line">    bind 10.2.1.30:18080 #监听的地址和端口，默认端口1080</span><br><span class="line">    mode http #模式</span><br><span class="line">    stats enable #启用状态监控</span><br><span class="line">    stats hide-version #隐藏软件版本号</span><br><span class="line">    stats auth admin:admin #登陆用户名和密码</span><br><span class="line">    stats realm HAproxy\ stats #提示信息，空格之前加\</span><br><span class="line">    stats admin if TRUE #当通过认证才可管理</span><br><span class="line">    stats uri &#x2F;stats #访问路径，在域名后面添加&#x2F;stats可以查看haproxy监控状态,默认为&#x2F;haproxy?stats</span><br><span class="line">    stats refresh 5 #页面自动刷新间隔,每隔5s刷新</span><br><span class="line"></span><br><span class="line">frontend rabbitmq_broker</span><br><span class="line">    bind 10.2.1.30:5672</span><br><span class="line">    default_backend rabbitmq_broker_backend</span><br><span class="line"></span><br><span class="line">backend rabbitmq_broker_backend</span><br><span class="line">	balance roundrobin</span><br><span class="line">	server lxg53 10.2.1.53:5672 check</span><br><span class="line">	server lxg54 10.2.1.54:5672 check</span><br><span class="line">    server lxg55 10.2.1.55:5672 check</span><br><span class="line"></span><br><span class="line">frontend rabbitmq_management</span><br><span class="line">    bind 10.2.1.30:15672</span><br><span class="line">    default_backend rabbitmq_management_backend</span><br><span class="line"></span><br><span class="line">backend rabbitmq_management_backend</span><br><span class="line">        balance roundrobin</span><br><span class="line">        server lxg53 10.2.1.53:15672 check</span><br><span class="line">        server lxg54 10.2.1.54:15672 check</span><br><span class="line">        server lxg55 10.2.1.55:15672 check</span><br><span class="line">	</span><br><span class="line">#---------------------------------------------------------------------</span><br><span class="line"># main frontend which proxys to the backends</span><br><span class="line">#---------------------------------------------------------------------</span><br><span class="line">#frontend  main *:5000</span><br><span class="line">#    acl url_static       path_beg       -i &#x2F;static &#x2F;images &#x2F;javascript &#x2F;stylesheets</span><br><span class="line">#    acl url_static       path_end       -i .jpg .gif .png .css .js</span><br><span class="line"></span><br><span class="line">#    use_backend static          if url_static</span><br><span class="line">#    default_backend             app</span><br><span class="line"></span><br><span class="line">#---------------------------------------------------------------------</span><br><span class="line"># static backend for serving up images, stylesheets and such</span><br><span class="line">#---------------------------------------------------------------------</span><br><span class="line">#backend static</span><br><span class="line">#    balance     roundrobin</span><br><span class="line">#    server      static 127.0.0.1:4331 check</span><br><span class="line"></span><br><span class="line">#---------------------------------------------------------------------</span><br><span class="line"># round robin balancing between the various backends</span><br><span class="line">#---------------------------------------------------------------------</span><br><span class="line">#backend app</span><br><span class="line">#    balance     roundrobin</span><br><span class="line">#    server  app1 127.0.0.1:5001 check</span><br><span class="line">#    server  app2 127.0.0.1:5002 check</span><br><span class="line">#    server  app3 127.0.0.1:5003 check</span><br><span class="line">#    server  app4 127.0.0.1:5004 check</span><br></pre></td></tr></table></figure>
<h2 id="最终效果"><a href="#最终效果" class="headerlink" title="最终效果"></a>最终效果</h2><p><img src="https://jxdw.github.io/img/business/rabbitmq/rabbit_cluster.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://jxdw.github.io/2017/12/22/rabbitmqctl-handbook/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/favicon.png">
      <meta itemprop="name" content="渐学顿悟">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="渐学顿悟">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/12/22/rabbitmqctl-handbook/" class="post-title-link" itemprop="url">【rabbitmq知识体系】(转载)rabbitmq手册之rabbitmqctl</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2017-12-22 19:52:16 19:52:16" itemprop="dateCreated datePublished" datetime="2017-12-22T19:52:16+08:00">2017-12-22 19:52:16</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2020-10-10 23:12:04 23:12:04" itemprop="dateModified" datetime="2020-10-10T23:12:04+08:00">2020-10-10 23:12:04</time>
      </span>

  
    <span id="/2017/12/22/rabbitmqctl-handbook/" class="post-meta-item leancloud_visitors" data-flag-title="【rabbitmq知识体系】(转载)rabbitmq手册之rabbitmqctl" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2017/12/22/rabbitmqctl-handbook/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2017/12/22/rabbitmqctl-handbook/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="原文地址"><a href="#原文地址" class="headerlink" title="原文地址"></a>原文地址</h1><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/61a90fba1d2a">https://www.jianshu.com/p/61a90fba1d2a</a></p>
<h1 id="application相关命令-集群管理的基础"><a href="#application相关命令-集群管理的基础" class="headerlink" title="application相关命令(集群管理的基础)"></a>application相关命令(集群管理的基础)</h1><h2 id="rabbitmqctl-stop-pid-file"><a href="#rabbitmqctl-stop-pid-file" class="headerlink" title="rabbitmqctl stop [{pid_file}]"></a>rabbitmqctl stop [{pid_file}]</h2><p>rabbitmqctl stop 或者 rabbitmqctl stop[{pid_file}]</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示stop 在RabbitMQ服务器上运行的一个Erlang节点，可以指定某一个 *pid_file*，表示会等待这个指定的程序结束</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-shutdown"><a href="#rabbitmqctl-shutdown" class="headerlink" title="rabbitmqctl shutdown"></a>rabbitmqctl shutdown</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示终止RabbitMQ 服务器上的Erlang进程，如果终止失败，会返回非零数字</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-stop-app"><a href="#rabbitmqctl-stop-app" class="headerlink" title="rabbitmqctl stop_app"></a>rabbitmqctl stop_app</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示终止RabbitMQ的应用，但是Erlang节点还在运行。该命令典型的运行在一些需要RabbitMQ应用被停止的管理行为之前，例如 reset</span><br></pre></td></tr></table></figure>
<p><img src="https://jxdw.github.io/img/business/rabbitmq/rabbitmq_startapp_status.png"><br><img src="https://jxdw.github.io/img/business/rabbitmq/rabbitmq_stopapp_status.png"></p>
<h2 id="rabbitmqctl-start-app"><a href="#rabbitmqctl-start-app" class="headerlink" title="rabbitmqctl start_app"></a>rabbitmqctl start_app</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示启动RabbitMQ的应用。该命令典型的运行在一些需要RabbitMQ应用被停止的管理行为之后，例如 reset</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-wait-pid-file"><a href="#rabbitmqctl-wait-pid-file" class="headerlink" title="rabbitmqctl wait {pid_file}"></a>rabbitmqctl wait {pid_file}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示等待RabbitMQ应用启动。该命令会等待指定的pid file被创建，也就是启动的进程对应的pid保存在这个文件中，然后RabbitMQ应用在这个进程中启动。如果该进程终止，没有启动RabbitMQ应用，就会返回错误。</span><br><span class="line">合适的pid file是有rabbitmq-server 脚本创建的，默认保存在 Mnesia 目录下，可以通过修改 RABBITMQ_PID_FILE 环境变量来修改例如 rabbitmqctl wait &#x2F;var&#x2F;run&#x2F;rabbitmq&#x2F;pid</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-reset"><a href="#rabbitmqctl-reset" class="headerlink" title="rabbitmqctl reset"></a>rabbitmqctl reset</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示设置RabbitMQ节点为原始状态。会从该节点所属的cluster中都删除，从管理数据库中删除所有数据，例如配置的用户和vhost，还会删除所有的持久消息。要想reset和force_reset操作执行成功，RabbitMQ应用需要处于停止状态，即执行过 stop_app</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-force-reset"><a href="#rabbitmqctl-force-reset" class="headerlink" title="rabbitmqctl force_reset"></a>rabbitmqctl force_reset</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示强制性地设置RabbitMQ节点为原始状态。它和reset的区别在于，可以忽略目前管理数据库的状态和cluster的配置，无条件的reset。</span><br><span class="line">该方法的使用，应当用在当数据库或者cluster配置损坏的情况下作为最后的方法。</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-rotate-logs-suffix"><a href="#rabbitmqctl-rotate-logs-suffix" class="headerlink" title="rabbitmqctl rotate_logs {suffix}"></a>rabbitmqctl rotate_logs {suffix}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示将日志文件的内容追加到新的日志文件中去，这个新的日志文件的文件名是原有的日志文件名加上命令中的 suffix，并且恢复日志到原来位置的新文件中。</span><br><span class="line">注意：如果新文件原先不存在，那么会新建一个；如果suffix为空，那么不会发生日志转移，只是重新打开了一次日志文件而已。</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-hipe-compile-directory"><a href="#rabbitmqctl-hipe-compile-directory" class="headerlink" title="rabbitmqctl hipe_compile {directory}"></a>rabbitmqctl hipe_compile {directory}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示在指定的目录下执行HiPE编译和缓存结果文件 .beam-files</span><br><span class="line">如果需要父目录会被创建。并且在编译之前，该目录下的所有 .beam-files会被自动删除。</span><br><span class="line">使用预编译的文件，你应该设置 RABBITMQ_SERVER_CODE_PATH 环境变量为 hipe_compile 调用指定的目录。</span><br></pre></td></tr></table></figure>

<h1 id="cluster-management-集群管理"><a href="#cluster-management-集群管理" class="headerlink" title="cluster management(集群管理)"></a>cluster management(集群管理)</h1><h2 id="rabbitmqctl-join-cluster-clusternode-–ram"><a href="#rabbitmqctl-join-cluster-clusternode-–ram" class="headerlink" title="rabbitmqctl join_cluster {clusternode} [–ram]"></a>rabbitmqctl join_cluster {clusternode} [–ram]</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示结合到指定的集群，如果有参数 --ram 表示作为RAM节点结合到该集群中。</span><br><span class="line">该命令指令本节结合到指定的集群中，在结合之前，该节点需要reset，所以在使用时，需要格外注意。为了成功运行本命令，必须要停止RabbitMQ应用，例如 stop_app</span><br><span class="line">集群节点有两种类型: disc 和 RAM。disc类型，复制数据在RAM和disc上，在节点失效的情况下，提供了冗余保证，也能从一些全局事件中恢复，例如所有节点失效。</span><br><span class="line">RAM类型，只复制数据在RAM上，主要表现在伸缩性上，特别是在管理资源（例如：增加删除队列，交换器，或者绑定）上表现突出。</span><br><span class="line">一个集群必须至少含有一个disc节点，当通常都多余一个。通过该命令时，默认是设置为disc节点，如果需创建RAM节点，需要指定参数 --ram</span><br><span class="line">执行此命令之后，在该节点上启动的RabbitMQ应用，在该节点挂掉之后，会尝试连接节点所在集群中的其他节点。为了离开集群，可以 reset 该节点，也可以使用命令 forget_cluster_node 远程删除节点</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-cluster-status"><a href="#rabbitmqctl-cluster-status" class="headerlink" title="rabbitmqctl cluster_status"></a>rabbitmqctl cluster_status</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示显示通过节点类型聚合在一起的集群中的所有节点，还有目前正在运行的节点</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-change-cluster-node-type-disc-ram"><a href="#rabbitmqctl-change-cluster-node-type-disc-ram" class="headerlink" title="rabbitmqctl change_cluster_node_type {disc|ram}"></a>rabbitmqctl change_cluster_node_type {disc|ram}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示改变集群节点的类型。该操作的正确执行，必定会停止该节点。并且在调整一个node为ram类型时，该节点不能为该集群的唯一node</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-forget-cluster-node-–offline"><a href="#rabbitmqctl-forget-cluster-node-–offline" class="headerlink" title="rabbitmqctl forget_cluster_node [–offline]"></a>rabbitmqctl forget_cluster_node [–offline]</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示远程移除一个集群节点。要删除的节点必须脱机，如果没有脱机，需要使用 --offline 参数。</span><br><span class="line">当使用 --offline 参数时，rabbitmqctl不会去连接节点，而是暂时变成节点，以便进行变更。</span><br><span class="line">这在节点不能正常启动时非常有用。在这种情况下，节点会成为集群元数据的规范来源（例如哪些队列存在）。因此如果可以的话，应该使用此命令在最新的节点上关闭。</span><br><span class="line">--offline 参数使节点从脱机节点上移除。使用场景主要是在所有节点脱机，且最后一个节点无法联机时，从而防止整个集群启动。在其他情况不应该使用，否则会导致不一致。</span><br><span class="line">例如 rabbitmqctl -n hare@mcnulty forget_cluster_node  rabbit@stringer 上述命令将从节点 hare@mcnulty 中移除节点 rabbit@stringer</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-rename-cluster-node-oldnode1-newnode1-oldnode2-newnode2…"><a href="#rabbitmqctl-rename-cluster-node-oldnode1-newnode1-oldnode2-newnode2…" class="headerlink" title="rabbitmqctl rename_cluster_node {oldnode1} {newnode1} [oldnode2] [newnode2…]"></a>rabbitmqctl rename_cluster_node {oldnode1} {newnode1} [oldnode2] [newnode2…]</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示在本地数据库上修改集群节点名称。该命令让rabbitmqctl暂时成为一个节点来做出做变更。因此，本地的待修改的集群节点一定要完全停止，其他节点可以是online或者offline</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-update-cluster-nodes-clusternode"><a href="#rabbitmqctl-update-cluster-nodes-clusternode" class="headerlink" title="rabbitmqctl update_cluster_nodes {clusternode}"></a>rabbitmqctl update_cluster_nodes {clusternode}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示指示已经集群的节点在唤醒时联系 &#123;clusternode&#125; 进行集群。这与 join_cluster 命令不同，因为它不加入任何集群，它是检查节点是否已经在具有 &#123;clusternode&#125; 的集群中。</span><br><span class="line">该命令的需求，是在当一个节点offline时，修改了集群节点的情形下。例如：节点A和B聚群，节点A offline了，节点C和B集群，并且B节点离开了该集群，那么当节点A起来的时候，A会尝试连接B，但是由于B节点已经不在该集群中，所以会失败。</span><br><span class="line">通过 update_cluster_nodes -n A C 将会解决上述问题。</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-force-boot"><a href="#rabbitmqctl-force-boot" class="headerlink" title="rabbitmqctl force_boot"></a>rabbitmqctl force_boot</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示强制确保节点启动，即使该节点并不是最后down的。</span><br><span class="line">一般情况下，当你同时shut down了RabbitMQ集群时，第一个重启的节点应该是最后一个down掉的，因为它可能已经看到了其他节点发生的事情。但是有时候这并不可能：例如当整个集群lose power，那么该集群的所有节点会认为他们不是最后一个关闭的。</span><br><span class="line">如果最后down的节点永久的lost，那么应该优先使用 rabbitmqctl forget_cluster_node --offline ，因为这将确保在丢失节点上的镜像队列得到优先处理。</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-sync-queue-p-vhost-queue"><a href="#rabbitmqctl-sync-queue-p-vhost-queue" class="headerlink" title="rabbitmqctl sync_queue [-p vhost] {queue}"></a>rabbitmqctl sync_queue [-p vhost] {queue}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;queue&#125; 表示待同步的队列名称</span><br><span class="line">指引含有异步slaves的镜像队列去同步自身。当队列执行同步化时，其将会被锁定（指所有publishers发送出去的和consumers获取到的队列都会被锁定）。为了成功执行此命令，队列必须要被镜像。</span><br><span class="line">注意，排除消息的异步队列将最终被同步化，此命令主要运用于未被排除完全消息的队列。</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-cancel-sync-queue-p-vhost-queue"><a href="#rabbitmqctl-cancel-sync-queue-p-vhost-queue" class="headerlink" title="rabbitmqctl cancel_sync_queue [-p vhost] {queue}"></a>rabbitmqctl cancel_sync_queue [-p vhost] {queue}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">指引一个正在同步的镜像队列停止此操作。</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-purge-queue-p-vhost-queue"><a href="#rabbitmqctl-purge-queue-p-vhost-queue" class="headerlink" title="rabbitmqctl purge_queue [-p vhost] {queue}"></a>rabbitmqctl purge_queue [-p vhost] {queue}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;queue&#125; 表示待清空消息的队列名称</span><br><span class="line">该命令表示清空队列（即删除队列中的所有消息）</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-set-cluster-name-name"><a href="#rabbitmqctl-set-cluster-name-name" class="headerlink" title="rabbitmqctl set_cluster_name {name}"></a>rabbitmqctl set_cluster_name {name}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">设置集群的名称。在连接中，集群的名称被声明在客户端上，被同盟和插件用来记录一个消息所在的位置。集群的名称默认来自于集群中第一个节点的主机名，但是可以被修改。</span><br></pre></td></tr></table></figure>

<h1 id="User-management-用户和角色管理"><a href="#User-management-用户和角色管理" class="headerlink" title="User management(用户和角色管理)"></a>User management(用户和角色管理)</h1><h2 id="用户角色"><a href="#用户角色" class="headerlink" title="用户角色"></a>用户角色</h2><p>rabbitmq用户角色（role）分为五类： </p>
<ul>
<li>超级管理员（administrator）<br>administrator可登录管理控制台（启用management plugin的情况下），查看所有的信息，并且可以对用户、策略（policy）进行操作。</li>
<li>监控者（monitor）<br>monitoring可登录管理控制台（启用management plugin的情况下），同时可以查看rabbitmq节点的相关信息（进程数、内存使用情况，磁盘使用情况等）。</li>
<li>决策制定者（policymaker）<br>policymaker可以登录管理控制台（启用management plugin的情况下），同时可以对策略（policy）进行操作。</li>
<li>普通管理者（management）<br>management 仅可登录管理控制台（启用management plugin的情况下），无法看到节点信息，也无法对策略进行管理。</li>
<li>其他<br>无法登录管理控制台，通常就是普通的生产者和消费者。<br>注意，rabbitmqctl 管理 RabbitMQ 的内部用户数据库，所有其他后台需要认证的用户对于rabbitmqctl将不可见。</li>
</ul>
<h2 id="rabbitmqctl-add-user-username-password"><a href="#rabbitmqctl-add-user-username-password" class="headerlink" title="rabbitmqctl add_user {username} {password}"></a>rabbitmqctl add_user {username} {password}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;username&#125; 表示用户名； ｛password｝表示用户密码</span><br><span class="line">该命令将创建一个 non-administrative 用户</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-delete-user-username"><a href="#rabbitmqctl-delete-user-username" class="headerlink" title="rabbitmqctl delete_user {username}"></a>rabbitmqctl delete_user {username}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示删除一个用户，该命令将指示RabbitMQ broker去删除指定的用户</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-change-password-username-newpassword"><a href="#rabbitmqctl-change-password-username-newpassword" class="headerlink" title="rabbitmqctl change_password {username} {newpassword}"></a>rabbitmqctl change_password {username} {newpassword}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示修改指定的用户的密码</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-clear-password-username"><a href="#rabbitmqctl-clear-password-username" class="headerlink" title="rabbitmqctl clear_password {username}"></a>rabbitmqctl clear_password {username}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示清除指定用户的密码</span><br><span class="line">执行此操作后的用户，将不能用密码登录，但是可能通过已经配置的SASL EXTERNAL的方式登录。</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-authenticate-user-username-password"><a href="#rabbitmqctl-authenticate-user-username-password" class="headerlink" title="rabbitmqctl authenticate_user {username} {password}"></a>rabbitmqctl authenticate_user {username} {password}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示指引RabbitMQ broker认证该用户和密码</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-set-user-tags-username-tag-…"><a href="#rabbitmqctl-set-user-tags-username-tag-…" class="headerlink" title="rabbitmqctl set_user_tags {username} {tag …}"></a>rabbitmqctl set_user_tags {username} {tag …}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示设置用户的角色，｛tag｝可以是零个，一个，或者是多个。并且已经存在的tag也将会被移除。</span><br><span class="line">rabbitmqctl set_user_tags tonyg administrator 该命令表示指示RabbitMQ broker确保用户tonyg为一个管理员角色。</span><br><span class="line">上述命令在用户通过AMQP方式登录时，不会有任何影响；但是如果通过其他方式，例如管理插件方式登录时，就可以去管理用户、vhost 和权限。</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-list-users"><a href="#rabbitmqctl-list-users" class="headerlink" title="rabbitmqctl list_users"></a>rabbitmqctl list_users</h2><p>作用:查看用户信息</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">结果如下</span><br><span class="line">Listing users ...</span><br><span class="line">guest   [administrator]</span><br><span class="line">...done.</span><br></pre></td></tr></table></figure>
<h2 id="rabbitmqctl-add-user-username-password-1"><a href="#rabbitmqctl-add-user-username-password-1" class="headerlink" title="rabbitmqctl add_user {username} {password}"></a>rabbitmqctl add_user {username} {password}</h2><p>创建新用户<br>例子:rabbitmqctl add_user jshan 123456</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">结果如下，表示创建成功</span><br><span class="line">Creating user &quot;jshan&quot; ...</span><br><span class="line">...done.</span><br></pre></td></tr></table></figure>

<p>再次查询结果如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Listing users ...</span><br><span class="line">guest   [administrator]</span><br><span class="line">jshan   []</span><br><span class="line">...done.</span><br></pre></td></tr></table></figure>
<p>上述结果中，第一列表示用户名，第二列表示用户角色</p>
<h2 id="rabbitmqctl-set-user-tags-username-role"><a href="#rabbitmqctl-set-user-tags-username-role" class="headerlink" title="rabbitmqctl set_user_tags {username} {role}"></a>rabbitmqctl set_user_tags {username} {role}</h2><p>作用:为用户设置用户角色<br>例子:rabbitmqctl set_user_tags jshan monitoring</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">结果如下，表示设置成功</span><br><span class="line">Setting tags for user &quot;jshan&quot; to [monitoring] ...</span><br><span class="line">...done.</span><br></pre></td></tr></table></figure>
<p>说明一下，执行该命令之后，会先删除该用户已有的角色，然后添加新的角色，可以填写多个角色，如果想删除某个用户的所有角色，可以设置如下：<br>rabbitmqctl set_user_tags {username}</p>
<h2 id="rabbitmqctl-change-password-username-newpassword-1"><a href="#rabbitmqctl-change-password-username-newpassword-1" class="headerlink" title="rabbitmqctl change_password {username} {newpassword}"></a>rabbitmqctl change_password {username} {newpassword}</h2><p>作用:修改用户密码<br>例子:rabbitmqctl change_password jshan 123</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">结果如下，表示修改成功</span><br><span class="line">Changing password for user &quot;jshan&quot; ...</span><br><span class="line">...done.</span><br></pre></td></tr></table></figure>


<h2 id="rabbitmqctl-clear-password-username-1"><a href="#rabbitmqctl-clear-password-username-1" class="headerlink" title="rabbitmqctl clear_password {username}"></a>rabbitmqctl clear_password {username}</h2><p>作用:清除用户密码<br>例子:rabbitmqctl clear_password jshan</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">结果如下，表示清除成功</span><br><span class="line">Clearing password for user &quot;jshan&quot; ...</span><br><span class="line">...done.</span><br><span class="line">说明一下，执行该命令之后，用户无法对该用户使用密码登录</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmq-delete-user-jshan"><a href="#rabbitmq-delete-user-jshan" class="headerlink" title="rabbitmq delete_user jshan"></a>rabbitmq delete_user jshan</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">删除用户 rabbitmqctl delete_user &#123;username&#125;</span><br><span class="line">结果如下，表示删除成功</span><br><span class="line">Deleting user &quot;jshan&quot; ...</span><br><span class="line">...done.</span><br></pre></td></tr></table></figure>

<h1 id="Access-control-访问控制"><a href="#Access-control-访问控制" class="headerlink" title="Access control(访问控制)"></a>Access control(访问控制)</h1><p>注意，rabbitmqctl 管理 RabbitMQ 的内部用户数据库，所有其他后台需要认证的用户的权限对于rabbitmqctl将不可见。</p>
<h2 id="rabbitmqctl-add-vhost-vhost"><a href="#rabbitmqctl-add-vhost-vhost" class="headerlink" title="rabbitmqctl add_vhost {vhost}"></a>rabbitmqctl add_vhost {vhost}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">｛vhost｝ 表示待创建的虚拟主机项的名称</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-delete-vhost-vhost"><a href="#rabbitmqctl-delete-vhost-vhost" class="headerlink" title="rabbitmqctl delete_vhost {vhost}"></a>rabbitmqctl delete_vhost {vhost}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示删除一个vhost。删除一个vhost将会删除该vhost的所有exchange、queue、binding、用户权限、参数和策略。</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-list-vhosts-vhostinfoitem-…"><a href="#rabbitmqctl-list-vhosts-vhostinfoitem-…" class="headerlink" title="rabbitmqctl list_vhosts {vhostinfoitem …}"></a>rabbitmqctl list_vhosts {vhostinfoitem …}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示列出所有的vhost。其中 &#123;vhostinfoitem&#125; 表示要展示的vhost的字段信息，展示的结果将按照 &#123;vhostinfoitem&#125; 指定的字段顺序展示。这些字段包括： name（名称） 和 tracing （是否为此vhost启动跟踪）。</span><br><span class="line">如果没有指定具体的字段项，那么将展示vhost的名称。</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-set-permissions-p-vhost-user-conf-write-read"><a href="#rabbitmqctl-set-permissions-p-vhost-user-conf-write-read" class="headerlink" title="rabbitmqctl set_permissions [-p vhost] {user} {conf} {write} {read}"></a>rabbitmqctl set_permissions [-p vhost] {user} {conf} {write} {read}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示设置用户权限。 &#123;vhost&#125; 表示待授权用户访问的vhost名称，默认为 &quot;&#x2F;&quot;； &#123;user&#125; 表示待授权反问特定vhost的用户名称； &#123;conf&#125;表示待授权用户的配置权限，是一个匹配资源名称的正则表达式； &#123;write&#125; 表示待授权用户的写权限，是一个匹配资源名称的正则表达式； &#123;read&#125;表示待授权用户的读权限，是一个资源名称的正则表达式。</span><br><span class="line">rabbitmqctl set_permissions -p myvhost tonyg &quot;^tonyg-.*&quot; &quot;.*&quot; &quot;.*&quot;</span><br><span class="line">例如上面例子，表示授权给用户 &quot;tonyg&quot; 在vhost为 &#96;myvhost&#96; 下有资源名称以 &quot;tonyg-&quot; 开头的 配置权限；所有资源的写权限和读权限。</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-clear-permissions-p-vhost-username"><a href="#rabbitmqctl-clear-permissions-p-vhost-username" class="headerlink" title="rabbitmqctl clear_permissions [-p vhost] {username}"></a>rabbitmqctl clear_permissions [-p vhost] {username}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示设置用户拒绝访问指定指定的vhost，vhost默认值为 &quot;&#x2F;&quot;</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-list-permissions-p-vhost"><a href="#rabbitmqctl-list-permissions-p-vhost" class="headerlink" title="rabbitmqctl list_permissions [-p vhost]"></a>rabbitmqctl list_permissions [-p vhost]</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示列出具有权限访问指定vhost的所有用户、对vhost中的资源具有的操作权限。默认vhost为 &quot;&#x2F;&quot;。</span><br><span class="line">注意，空字符串表示没有任何权限。</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-list-user-permissions-username"><a href="#rabbitmqctl-list-user-permissions-username" class="headerlink" title="rabbitmqctl list_user_permissions {username}"></a>rabbitmqctl list_user_permissions {username}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示列出指定用户的权限vhost，和在该vhost上的资源可操作权限。</span><br></pre></td></tr></table></figure>

<h1 id="Parameter-Management-参数管理"><a href="#Parameter-Management-参数管理" class="headerlink" title="Parameter Management(参数管理)"></a>Parameter Management(参数管理)</h1><p>RabbitMQ的一些特性（例如联合插件）是被动态的、集群范围内的参数控制。有两类参数：属于vhost的参数和全局参数。一个属于vhost的参数由三部分组成： 组件名称，参数名称和值。其中组件名称和名称是字符串，值是一个Erlang项。<br>一个全局参数由两部分组成： 参数名称和值。其中名称是字符串，值是一个Erlang项。参数可以被设置，删除，列出。参数的具体设置方法如下：</p>
<h2 id="rabbitmqctl-set-parameter-p-vhost-component-name-name-value"><a href="#rabbitmqctl-set-parameter-p-vhost-component-name-name-value" class="headerlink" title="rabbitmqctl set_parameter [-p vhost] {component_name} {name} {value}"></a>rabbitmqctl set_parameter [-p vhost] {component_name} {name} {value}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">设置参数，｛component_name｝表示待设置参数的组件名称，&#123;name&#125; 表示待设置的参数名称，｛value｝表示待设置的参数值，是一个JSON项，在多数shell中，你很有可能要应用该值</span><br></pre></td></tr></table></figure>
<h2 id="rabbitmqctl-set-parameter-federation-local-username-‘“guest”‘"><a href="#rabbitmqctl-set-parameter-federation-local-username-‘“guest”‘" class="headerlink" title="rabbitmqctl set_parameter federation local_username ‘“guest”‘"></a>rabbitmqctl set_parameter federation local_username ‘“guest”‘</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">上述例子，表示设置默认vhost即 &quot;&#x2F;&quot; 的 federation 组件的参数 local_username 的值设置为JSON项 &quot;guest&quot;</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-clear-parameter-p-vhost-component-name-key"><a href="#rabbitmqctl-clear-parameter-p-vhost-component-name-key" class="headerlink" title="rabbitmqctl clear_parameter [-p vhost] {component_name} {key}"></a>rabbitmqctl clear_parameter [-p vhost] {component_name} {key}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示清理一个参数，｛component_name｝表示待清理的组件名称，｛key｝表示待清理的参数名称</span><br><span class="line">rabbitmqctl clear_parameter federation local_username</span><br><span class="line">上述例子表示清理默认vhost上的组件 federation 的参数 local_username</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-list-parameters-p-vhost"><a href="#rabbitmqctl-list-parameters-p-vhost" class="headerlink" title="rabbitmqctl list_parameters [-p vhost]"></a>rabbitmqctl list_parameters [-p vhost]</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示列举出指定的vhost上的所有参数</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-set-global-parameter-name-value"><a href="#rabbitmqctl-set-global-parameter-name-value" class="headerlink" title="rabbitmqctl set_global_parameter {name} {value}"></a>rabbitmqctl set_global_parameter {name} {value}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">设置一个全局运行时的变量，有些类似于 set_parameter ，但是此 key-value 对并不绑定于vhost。 </span><br><span class="line">rabbitmqctl set_global_parameter mqtt_default_vhosts &#39;&#123;&quot;O&#x3D;client,CN&#x3D;guest&quot;:&quot;&#x2F;&quot;&#125;&#39;</span><br><span class="line">上述例子，设置一个全局运行时的参数 mqtt_default_vhosts 的值为一个JSON项， &#123;&quot;O&#x3D;client,CN&#x3D;guest&quot;:&quot;&#x2F;&quot;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-clear-global-parameter-name"><a href="#rabbitmqctl-clear-global-parameter-name" class="headerlink" title="rabbitmqctl clear_global_parameter {name}"></a>rabbitmqctl clear_global_parameter {name}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">清除一个全局运行时参数，类似于 clear_parameter，但是此 key-value 对并不绑定于vhost。</span><br><span class="line">rabbitmqctl clear_global_parameter mqtt_default_vhosts</span><br><span class="line">上述例子，清除一个全局运行时参数 mqtt_default_vhosts</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-list-global-parameters"><a href="#rabbitmqctl-list-global-parameters" class="headerlink" title="rabbitmqctl list_global_parameters"></a>rabbitmqctl list_global_parameters</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">列出所有的全局运行时参数，类似于 list_parameters，但是该命令不绑定于任何vhost</span><br></pre></td></tr></table></figure>

<h1 id="Policy-Management-策略管理"><a href="#Policy-Management-策略管理" class="headerlink" title="Policy Management(策略管理)"></a>Policy Management(策略管理)</h1><h2 id="rabbitmqctl-set-policy-p-vhost-–priority-priority-–apply-to-apply-to-name-pattern-definition"><a href="#rabbitmqctl-set-policy-p-vhost-–priority-priority-–apply-to-apply-to-name-pattern-definition" class="headerlink" title="rabbitmqctl set_policy [-p vhost] [–priority priority] [–apply-to apply-to] {name} {pattern} {definition}"></a>rabbitmqctl set_policy [-p vhost] [–priority priority] [–apply-to apply-to] {name} {pattern} {definition}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;name&#125; 表示策略名称；</span><br><span class="line">&#123;pattern&#125; 表示当匹配到给定资源的正则表达式，使的该策略得以应用； </span><br><span class="line">&#123;definition&#125; 表示策略的定义，作为一个JSON项，在多数shell中，你很可能需要去应用它</span><br><span class="line">&#123;priority&#125; 表示策略的优先级的整数，数据越大表示优先级越高，默认值为0</span><br><span class="line">&#123;apply_to&#125; 表示策略应该应用的类型： queues&#x2F;exchange&#x2F;all，默认值是 all</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-clear-policy-p-vhost-name"><a href="#rabbitmqctl-clear-policy-p-vhost-name" class="headerlink" title="rabbitmqctl clear_policy [-p vhost] {name}"></a>rabbitmqctl clear_policy [-p vhost] {name}</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示清理一个策略。 &#123;name&#125; 表示待清理的策略名称</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-list-policies-p-vhost"><a href="#rabbitmqctl-list-policies-p-vhost" class="headerlink" title="rabbitmqctl list_policies [-p vhost]"></a>rabbitmqctl list_policies [-p vhost]</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">表示列举出给定的vhost的所有策略信息</span><br></pre></td></tr></table></figure>

<h1 id="Server-Status-服务状态"><a href="#Server-Status-服务状态" class="headerlink" title="Server Status(服务状态)"></a>Server Status(服务状态)</h1><h2 id="rabbitmqctl-list-queues-p-vhost-–offline-–online-–local-queueinfoitem-…"><a href="#rabbitmqctl-list-queues-p-vhost-–offline-–online-–local-queueinfoitem-…" class="headerlink" title="rabbitmqctl list_queues [-p vhost] [[–offline] | [–online] | [–local]] [queueinfoitem …]"></a>rabbitmqctl list_queues [-p vhost] [[–offline] | [–online] | [–local]] [queueinfoitem …]</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">返回队列的详细信息。如果 &quot;-p&quot; 标志不存在，那么将返回默认虚拟主机的队列详细信息。&quot;-p&quot; 可以用来覆盖默认vhost。可以使用一下互斥选项之一，通过其状态或者位置过滤显示的队列。</span><br><span class="line">[--offline] 表示仅仅列出当前不可用的持久队列（更具体地说，他们的主节点不是）</span><br><span class="line">[--online] 表示列出当前可用的队列（他们的主节点是）</span><br><span class="line">[--local] 表示仅仅列出那些主程序在当前节点上的队列</span><br><span class="line">queueinfoitem参数用于指示要包括在结果中的哪些队列信息项。结果中的列顺序将与参数的顺序相匹配。queueinfoitem可以从以下列表中获取任何值：</span><br><span class="line">name 表示队列的名称</span><br><span class="line">durable 表示服务器重启之后，队列是否存活</span><br><span class="line">auto_delete 表示不再使用的队列是否自动被删除</span><br><span class="line">arguments 表示队列的参数</span><br><span class="line">policy 表示应用在队列中的策略名称</span><br><span class="line">pid 表示和队列相关联的Erlang进程的ID</span><br><span class="line">owner_pid 表示作为队列的排他所有者的连接的Erlang进程的ID，如果队列是非排他，则为空</span><br><span class="line">exclusive 表示队列是否是排他的，有 owner_pid 返回 True，否则返回 False</span><br><span class="line">exclusive_consumer_pid 表示排他消费者订阅该队列的频道的Erlang进程的ID，如果没有独家消费者，则为空</span><br><span class="line">exclusive_consumer_tag 表示订阅该队列的排他消费者的消费tag。如果没有排他消费者，则为空</span><br><span class="line">messages_ready 表示准备被发送到客户端的消息数量</span><br><span class="line">messages_unacknowledged 表示已经被发送到客户端但是还没有被确认的消息数量</span><br><span class="line">messages 表示准备发送和没有被确认的消息数量总和（队列深度）</span><br><span class="line">messages_ready_ram 表示驻留在 ram 里的 messages_ready 的消息数量</span><br><span class="line">messages_unacknowledged_ram 表示驻留在 ram 里的 messages_unacknowledged 的消息数量</span><br><span class="line">messages_ram 表示驻留在 ram 里的消息总数</span><br><span class="line">messages_persistent 表示队列中持久消息的总数（对于临时队列，总是为0）</span><br><span class="line">message_bytes 表示在队列中所有消息body的大小，这并不包括消息属性（包括header）或者任何开销</span><br><span class="line">message_bytes_ready 表示类似于 messge_bytes 但仅仅计算那些将发送到客户端的消息</span><br><span class="line">message_bytes_unacknowledged 表示类似于 message_bytes 但仅仅计算那些已经发送到客户还没有确认的消息</span><br><span class="line">message_bytes_ram 表示类似于 message_bytes 但仅仅计算那些驻留在ram中的消息</span><br><span class="line">message_bytes_persistent 表示类似于 message_bytes 但仅仅计算那些持久消息</span><br><span class="line">head_message_timestamp 表示队列中第一个消息的时间戳属性（如果存在）。只有处在 paged-in 状态的消息才存在时间戳。</span><br><span class="line">disk_reads 表示该队列自start起，从磁盘读取消息的次数总和</span><br><span class="line">disk_writes 表示该队列自start起，被写入磁盘消息的次数总和</span><br><span class="line">consumers 表示consumer的数量</span><br><span class="line">consumer_utilisation 表示队列能够立即将消息传递给消费者的时间分数（0.0 ~ 1.0之间），如果消费者受到网络拥塞或者预取计数的限制，该值可能小于1.0</span><br><span class="line">memory 表示和该队列相关联的Erlang进程消耗的内存字节数，包括stack&#x2F;heap&#x2F;内部数据结构</span><br><span class="line">slave_pids 表示该队列目前的slave的ID号（如果该队列被镜像的话）</span><br><span class="line">synchronised_slave_pids 表示如果队列被镜像，给出与主队列同步的当前slave的ID号，即可以从主队列接管而不丢失消息的slave的ID</span><br><span class="line">state 表示队列的状态，一般是 &quot;running&quot;； 如果队列正在同步，也可能是 &quot;&#123;syncing, MsgCount&#125;&quot;； 如果队列所处的节点当前down了，队列显示的状态为 &quot;down&quot;</span><br><span class="line">如果没有指定queueinfoitem，那么将显示队列的名称（name）和深度（messages）</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-list-exchanges-p-vhost-exchangeinfoitem-…"><a href="#rabbitmqctl-list-exchanges-p-vhost-exchangeinfoitem-…" class="headerlink" title="rabbitmqctl list_exchanges [-p vhost] [exchangeinfoitem …]"></a>rabbitmqctl list_exchanges [-p vhost] [exchangeinfoitem …]</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">返回交换器的详细信息。如果 &quot;-p&quot; 标志不存在，那么将返回默认虚拟主机的交换器详细信息。&quot;-p&quot; 可以用来覆盖默认vhost。</span><br><span class="line">exchangeinfoitem参数用于指示要包括在结果中的哪些交换器信息项。结果中的列顺序将与参数的顺序相匹配。exchangeinfoitem可以从以下列表中获取任何值：</span><br><span class="line">name 表示交换器的名称</span><br><span class="line">type 表示交换器类型（例如： direct&#x2F;topic&#x2F;fanout&#x2F;headers）</span><br><span class="line">durable 表示服务器重启之后，交换器是否存活</span><br><span class="line">auto_delete 表示交换器不再使用时，是否被自动删除</span><br><span class="line">internal 表示交换器是否是内部的，例如不能被客户端直接发布</span><br><span class="line">arguments 表示交换器的参数</span><br><span class="line">policy 表示引用在该交换器上的策略名称</span><br><span class="line">如果没有指定任何 exchangeinfoitem，那么该命令将显示交换器的名称（name）和类型（type）</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-list-bindings-p-vhost-bindinginfoitem-…"><a href="#rabbitmqctl-list-bindings-p-vhost-bindinginfoitem-…" class="headerlink" title="rabbitmqctl list_bindings [-p vhost] [bindinginfoitem …]"></a>rabbitmqctl list_bindings [-p vhost] [bindinginfoitem …]</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">返回绑定的详细信息。如果 &quot;-p&quot; 标志不存在，那么将返回默认虚拟主机的绑定详细信息。&quot;-p&quot; 可以用来覆盖默认vhost。</span><br><span class="line">bindinginfoitem参数用于指示要包括在结果中的哪些绑定信息项。结果中的列顺序将与参数的顺序相匹配。bindinginfoitem可以从以下列表中获取任何值：</span><br><span class="line">source_name 表示绑定附加到的消息源的名称</span><br><span class="line">source_kind 表示绑定附加到的消息源的类型，目前通常交换器</span><br><span class="line">destination_name 表示附加绑定到的消息目的地的名称</span><br><span class="line">destination_kind 表示附加绑定到的消息目的地的类型</span><br><span class="line">routing_key 表示绑定的routing key</span><br><span class="line">arguments 表示绑定的参数</span><br><span class="line">如果没有指定任何的 bindinginfoitem ，那么将展示上述所有的参数</span><br><span class="line">rabbitmqctl list_bindings -p &#x2F;myvhost exchange_name queue_name</span><br><span class="line">上述命令，表示展示在 &#x2F;myvhost 虚拟主机中的绑定的exchange名称和queue名称</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-list-connections-connectioninfoitem-…"><a href="#rabbitmqctl-list-connections-connectioninfoitem-…" class="headerlink" title="rabbitmqctl list_connections [connectioninfoitem …]"></a>rabbitmqctl list_connections [connectioninfoitem …]</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">返回TCP&#x2F;IP连接统计信息</span><br><span class="line">connectioninfoitem 参数用于指示要包括在结果中的哪些连接信息项，结果中的列顺序将与参数的顺序相匹配。connectioninfoitem可以从以下列表中获取任何值：</span><br><span class="line">pid 表示与该connection相关联的Erlang进程的id号</span><br><span class="line">name 表示该连接的可读性名称</span><br><span class="line">port 表示服务端口</span><br><span class="line">host 表示通过反向DNS获取的服务器主机名，如果反向DNS失败或未启用，则为其IP地址</span><br><span class="line">peer_port 表示对等端口</span><br><span class="line">peer_host 表示通过反向DNS获取的对等主机名，如果反向DNS失败或未启用，则为其IP地址</span><br><span class="line">ssl 表示该连接是否使用SSL保护的bool值</span><br><span class="line">ssl_protocal 表示SSL协议(例如： tlsv1)</span><br><span class="line">ssl_key_exchange 表示SSL关键交换器算法（例如： rsa）</span><br><span class="line">ssl_cipher 表示SSL密码算法（例如： aes_256_cbc）</span><br><span class="line">ssl_hash 表示SSL哈希函数（例如： sha）</span><br><span class="line">peer_cert_issuer 表示对等体的SSL证书的颁发者，以RFC4514形式出现</span><br><span class="line">peer_cert_validity 表示对等体的SSL证书的有效期限</span><br><span class="line">state 表示连接状态（例如： starting&#x2F;tuning&#x2F;opening&#x2F;running&#x2F;flow&#x2F;blocking&#x2F;blocked&#x2F;closing&#x2F;closed）</span><br><span class="line">channels 表示正在使用连接的通道数量</span><br><span class="line">protocol 表示正在使用的AMQP的版本号。注意，如果一个客户端需要一个AMQP 0-9 连接，我们将其作为 AMQP 0-9-1</span><br><span class="line">auth_mechanism 表示使用SASL认证机制，如PLAN</span><br><span class="line">user 表示和该连接相关联的用户名</span><br><span class="line">vhost 表示vhost名称</span><br><span class="line">timeout 表示连接超时&#x2F;协商心跳间隔，单位为秒</span><br><span class="line">frame_max 表示最大的frame大小（byte）</span><br><span class="line">channel_max 表示该连接上通道的最大数量</span><br><span class="line">client_properties 表示在连接建立期间，有客户端传送的消息属性</span><br><span class="line">recv_oct 表示接受到的八位字节</span><br><span class="line">recv_cnt 表示接受到的包</span><br><span class="line">send_oct 表示发送的八位字节</span><br><span class="line">send_cnt 表示发送的包</span><br><span class="line">send_pend 表示发送的队列大小</span><br><span class="line">connected_at 表示该连接被建立的日期和时间的时间戳格式</span><br><span class="line">如果没有指定任何connectioninfoitem，那么将展示：user&#x2F;peer_host&#x2F;peer_port&#x2F;流量控制和内存块状态之后的时间</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-list-channels-channelinfoitem-…"><a href="#rabbitmqctl-list-channels-channelinfoitem-…" class="headerlink" title="rabbitmqctl list_channels [channelinfoitem …]"></a>rabbitmqctl list_channels [channelinfoitem …]</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">返回所有当前的通道的信息，通道即一个执行大多数AMQP命令的逻辑容器。这包括由普通AMQP连接的一部分通道、由各种插件和其他扩展程序创建的通道。</span><br><span class="line">channelinfoitem 参数用于指示要包括在结果中的哪些连接信息项，结果中的列顺序将与参数的顺序相匹配。channelinfoitem 可以从以下列表中获取任何值：</span><br><span class="line">pid 表示与该连接相关联的Erlang程序的ID号</span><br><span class="line">connection 表示与通道所属连接相关联的Erlang进程的ID号</span><br><span class="line">name 表示通道的可读性名称</span><br><span class="line">number 表示通道的号码，在连接中唯一表示它</span><br><span class="line">user 表示和该通道相关联的用户名</span><br><span class="line">vhost 表示通道操作所在的vhost</span><br><span class="line">transactional 表示通道是否处于事务模式，返回 true，否则返回 false</span><br><span class="line">confirm 表示通道是否处于确认模式，返回 true, 否则返回 false</span><br><span class="line">consumer_count 表示通过通道检索消息的逻辑AMQP消费者数量</span><br><span class="line">messages_unacknowledged 表示通过通道发送过但还没收到反馈的消息的数量</span><br><span class="line">messages_uncommitted 表示尚未提交的事务中接受的消息数</span><br><span class="line">acks_uncommitted 表示尚未提交的事务中接受的确认数</span><br><span class="line">messages_unconfirmed 表示尚未确认已发布的消息数量。在不处于确认模式中的通道上，该值为0</span><br><span class="line">prefetch_count 表示新消费者的QoS预取限制，如果没有限制则为0</span><br><span class="line">global_prefetch_count 表示整个通道的QoS预取限制，如果没有限制则为0</span><br><span class="line">如果没有指定任何 channelinfoitem 项，那么将展示 pid&#x2F;user&#x2F;consumer_count&#x2F;messages_unacknowledged</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-list-consumers-p-vhost"><a href="#rabbitmqctl-list-consumers-p-vhost" class="headerlink" title="rabbitmqctl list_consumers [-p vhost]"></a>rabbitmqctl list_consumers [-p vhost]</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">列出消费者，例如对一个队列的消息流的订阅者。每一行用tab字符分隔：</span><br><span class="line">订阅的队列名称、创建和管理订阅的通道id、在通道中唯一标识订阅的消费者tag、消息传输到订阅者之后是否需要确认的bool值、代表预取限制的整数（0表示none）、订阅者的其他参数</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-status"><a href="#rabbitmqctl-status" class="headerlink" title="rabbitmqctl status"></a>rabbitmqctl status</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">展示broker的状态信息，例如在当前Erlang节点上正在运行的应用、RabbitMQ和Erlang版本号、OS名称、内存和文件描述统计信息</span><br></pre></td></tr></table></figure>

<h2 id="rabbitmqctl-node-health-check"><a href="#rabbitmqctl-node-health-check" class="headerlink" title="rabbitmqctl node_health_check"></a>rabbitmqctl node_health_check</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">RabbitMQ节点的健康检查，验证 Rabbit 应用正在运行，list_queues和list_channels返回，警告没有被设置</span><br><span class="line">rabbitmqctl node_health_check -n rabbit@stringer</span><br><span class="line">上述例子，表示对RabbitMQ节点进行健康检查</span><br><span class="line">&#96;&#96;&#96;&#96;</span><br><span class="line"></span><br><span class="line">## rabbitmqctl environment</span><br></pre></td></tr></table></figure>
<p>在每个正在运行的应用程序的应用程序环境中，显示每个变量的名称和值</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">## rabbitmqctl report</span><br></pre></td></tr></table></figure>
<p>生成服务器状态报告，其中包括用于支持目的的所有服务器状态信息的并置。当伴随支持请求时，输出应该被重定向到一个文件<br>rabbitmqctl report &gt; server_report.txt</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">## rabbitmqctl eval &#123;expr&#125;</span><br></pre></td></tr></table></figure>
<p>评估一个任务Erlang表达式<br>rabbitmqctl eval ‘node().’<br>上述例子，将返回 rabbitmqctl 已经连接的节点名称</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"># Miscellaneous(繁杂)</span><br><span class="line">##  rabbitmqctl close_connection &#123;connectionpid&#125; &#123;explanation&#125;</span><br></pre></td></tr></table></figure>
<p>{connectionpid} 表示待关闭连接的Erlang进程的ID号<br>{explanation} 表示解释字符串<br>指引broker去关闭与ID为 {connectionid} Erlang进程相关联的连接，作为AMQP连接关闭协议的一部分，它也会向连接的客户端传递 {explanation} 字符串<br>rabbitmqctl close_connection “<a href="mailto:&#x72;&#97;&#98;&#x62;&#105;&#x74;&#x40;&#x74;&#97;&#110;&#116;&#111;&#46;&#x34;&#x32;&#x36;&#x32;&#x2e;&#x30;">&#x72;&#97;&#98;&#x62;&#105;&#x74;&#x40;&#x74;&#97;&#110;&#116;&#111;&#46;&#x34;&#x32;&#x36;&#x32;&#x2e;&#x30;</a>“ “go away”<br>上述例子，表示关闭与ID号为 “<a href="mailto:&#x72;&#x61;&#98;&#98;&#105;&#x74;&#x40;&#116;&#97;&#x6e;&#116;&#x6f;&#x2e;&#52;&#x32;&#x36;&#50;&#x2e;&#48;">&#x72;&#x61;&#98;&#98;&#105;&#x74;&#x40;&#116;&#97;&#x6e;&#116;&#x6f;&#x2e;&#52;&#x32;&#x36;&#50;&#x2e;&#48;</a>“ 的Erlang进程相关联的连接，并向连接的客户端传输解释性语句 “go away”。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">## rabbitmqctl trace_on [-p vhost]</span><br></pre></td></tr></table></figure>
<p>vhost 表示要启动跟踪的虚拟机名称。开始跟踪。注意，跟踪状态不是持久的，如果服务重启，它将恢复为关闭</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">## rabbitmqctl trace_off [-p vhost]</span><br><span class="line">作用:停止跟踪</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## rabbitmqctl set_vm_memory_high_watermark &#123;fraction&#125;</span><br></pre></td></tr></table></figure>
<p>{fraction} 触发流量控制的新内存阈值分数，大于或等于0的浮点数</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">## rabbitmqctl set_vm_memory_high_watermark absolute &#123;memory_limit&#125;</span><br></pre></td></tr></table></figure>
<p>{memory_limit} 触发流量控制的新内存限制，以字节表示，大于或等于0的整数或作为具有存储单元（例如： 512M或者1G），可用的单位有：<br>k/kiB： kibibytes(2^10字节)； M/MiB: mebibytes(2^20字节)； G/GiB: gibibytes(2^30字节)<br>kB: kilobytes(10^3); MB: megabytes(10^6); GB: gigabytes(10^9)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">## rabbitmqctl set_disk_free_limit &#123;disk_limit&#125;</span><br></pre></td></tr></table></figure>
<p>{disk_limit} 下限为字节整数或具有存储单元的字符串（参见 vm_memory_high_watermark 命令），例如： 512M或1G，一旦可用磁盘空间达到限制，将会设置磁盘告警</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">## rabbitmqctl set_disk_free_limit mem_relative &#123;fraction&#125;</span><br></pre></td></tr></table></figure>
<p>{fraction} 相对于可用RAM的限制，为非负的浮点数。低于1.0的值可能是危险的，应小心使用。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">## rabbitmqctl encode [--decode] [value] [passphrase] [--list-ciphers] [--list-hashes] [--cipher cipher] [--hash hash] [--iterations iteraions]</span><br></pre></td></tr></table></figure>
<p>[–decode] 表示解密输入值的标志位。例如: rabbitmqctl encode –decode ‘{encrypted,’&lt;&lt;”…”&gt;&gt;}’ mypassphrase<br>[value] [passphrase] 表示加密和解密的值、密码。 例如： rabbitmqctl encode ‘&lt;&lt;”guest”&gt;&gt;’ mypassphrase 。例如： rabbitmqctl encode –decode ‘{encrypted,’&lt;&lt;”…”&gt;&gt;}’ mypassphrase<br>[–list-ciphers] 表示列出支持的密码标志位。例如： rabbitmqctl encode –list-ciphers。<br>[–list-hashes] 表示列出支持的哈希算法标志位。例如： rabbitmqctl encode –list-hashes。<br>[–cipher cipher] [–hash hash] [–iterations iterations] 表示用于指定加密设置的选项，它们可以独立使用。例如： rabbitmqctl encode –cipher blowfish_cfb64 –hash sha256 –iterations 1000 ‘&lt;&lt;”guest”&gt;&gt;’ mypassphrase<br>```</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>





  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/7/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/9/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



      

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      

      

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">渐学顿悟</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  


















  






<script>
  (function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      const visitors = document.querySelector('.leancloud_visitors');
      const url = decodeURI(visitors.id);
      const title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            const counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              leancloudSelector(url).innerText = 'Counter not initialized! More info at console err msg.';
              console.error('ATTENTION! LeanCloud counter has security bug, see how to solve it here: https://github.com/theme-next/hexo-leancloud-counter-security. \n However, you can still use LeanCloud without security, by setting `security` option to `false`.');
            
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      const visitors = document.querySelectorAll('.leancloud_visitors');
      const entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            const target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    const { app_id, app_key, server_url } = {"enable":true,"app_id":"wrre3Nrx21CqKiChLnKn034M-gzGzoHsz","app_key":"rkWWNONo7LAJhlS936vnywQ9","server_url":null,"security":true};
    function fetchData(api_server) {
      const Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    const api_server = app_id.slice(-9) === '-MdYXbMMI' ? `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com` : server_url;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script>


  

  

<script>
NexT.utils.loadComments('#valine-comments', () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js', () => {
    new Valine(Object.assign({"enable":true,"appId":"wrre3Nrx21CqKiChLnKn034M-gzGzoHsz","appKey":"rkWWNONo7LAJhlS936vnywQ9","serverURLs":null,"placeholder":"请输入您的评论","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"lang":null,"visitor":false,"comment_count":true,"recordIP":false,"enableQQ":false,"requiredFields":["nick","mail"]}, {
      el: '#valine-comments',
      path: "/page/8/",
      serverURLs: "https://wrre3nrx.api.lncldglobal.com"
    }));
  }, window.Valine);
});
</script>

</body>
</html>
